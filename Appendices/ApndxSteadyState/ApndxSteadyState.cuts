
  % At a proportion $\Die$ of the locations, the agent `dies' and is replaced by a newborn.  The probability that the agent will live is the cancellation of the probability of death: $\Liv$.  Thus there is a total population after $n$ periods of:
  % \begin{align}
      %       \Pop_{\FutPer+1} & = \Pop_{\FutPer}\left(\Die+\Liv\right)
                                 %       \\ & = \Pop_{0}\Die\sum_{i=0}^{\FutPer}\left(\frac{1-\Liv^{\FutPer+1}}{1-\Liv}\right).
                                              %     \end{align}

                                              %                                               Defining $\pLev$ as `permanent income' and $\pLog = \log ~ \pLev$ as its log, among the set of survivors from $\tAbs$ to $\tAbs+1$,
                                              %                                               \begin{align}
                                              %                                               \pLog_{\tAbs+1} & = \pLog_{\tAbs} + \pShk_{\tAbs+1}
                                                                                                                %     \end{align}
                                                                                                                %                                                                                                                 Locations where death occurs are repopulated by new agents; the initial permanent income of new agents is $\pLev=1$.

                                                                                                                %                                                                                                                 Here we derive the steady-state distribution of $\pLog$ in an economy like the one described above.

                                                                                                                %                                                                                                                 In a break with the typical exposition, the following derivations are explicitly articulated as discrete representations which approach the continuous abstractions as the population size approaches infinity.  This choice makes the mapping between the mathematical description and its computational instantiation more transparent (and debuggable) than the usual approach of assuming an infinitely large number of infinintely small agents (which is the limit of this representation, at least for the rational numbers).

                                                                                                                %                                                                                                                 Much of what follows will assume that the population size $L$ is large enough that events that occur after a certain number of periods can be neglected.  There are computational approximations (which are so obvious that they do not warrant exposition) that should make this approach adequate for computationally reasonable simulation sizes.

                                                                                                                %                                                                                                                 Imagine an economy that starts at date 0 with a population of integer size $\Pop$ whose addresses are indexed by $\posn \in \{1,\Pop\}$ (these will be represented computationally by a simulated population $\Pop$ in which each member of the population at any date $\tAbs$ occupies a slot at integer location $\posn$).  

                                                                                                                %                                                                                                                 At date $\tAbs$ a person at location $\posn$ has level of permanent income of $\pLev_{\tAbs,\posn}$ and the economy starts at date 0 with $\pLev_{0,\posn}=1~\forall~\posn$.


\input{./econtexRoot}\documentclass[\econtexRoot/BufferStockTheory.tex]{subfiles}\usepackage{ApndxSteadyState}
\input{\econtexRoot/\ApndxDir/onlyinsubfile}\begin{document}

  \section{The Steady-State Distribution of Permanent Income}
  \Biggen
  Imagine an economy that begins functioning at date 1 with a population of size $\Pop_{0}$ living at locations indexed by  $\posn$.\footnote{These will be represented computationally by a simulated population of integer size $\Pop_{0}$ in which each member of the population at any date $\tAbs$ occupies a slot at integer location $\posn$).}  Immediately prior to date 1, all agents have a value of `permanent income' $\pLev_{0,\posn}=1$. 

  Here we derive the dynamics of the distribution of $\pLev_{\FutPer,\posn}$ across locations, and the limiting distribution as $\FutPer \rightarrow \infty$, when each period the agent at each location receives an idiosyncratic shock to $\pLog = \log ~ \pLev$ until `death,' at which point the agent is replaced by a `newborn.'\footnote{This is a discrete version of the `perpetual youth' model of  \cite{blanchardFinite}.} %To make the computational instantiation transparent (and debuggable), we are more explicit than usual in denoting sets.


  \begin{enumerate}
  \item The first thing that happens at date $\tAbs$ is that agents living at a randomly selected constant proportion $\Die$ of locations die and are replaced by newborns; $\{\Die_{\tAbs}\}$ is the set of such locations.  Locations where death does not occur are in the set  $\{\Liv_{\tAbs}\}$ (death has been canceled - for now), and of course $\Liv=1-\Die$ and $0 < \Die < 1$.

  \item The initial permanent income of newborns is  $\pLev=1$ (formally, $\pLev_{\tAbs,\posn} = 1~\forall~\posn~\in~\{\Die_{\tAbs}\}$)
  \item Next, every location is subjected to a mean-one lognormally distributed shock
    \begin{align}
      \pShk & \equiv \log \PShk \sim \mathcal{N}(\pShkMean,\sigma^{2}_{\DnsShk}) \label{eq:pShkDef}
    \end{align}
    where $\pShkMean = -\sigma^{2}_{\DnsShk}/2.$  That is, for all $\pLog \in \Liv_{\tAbs}$, 
    \begin{align}
      \pLog_{\tAbs} & = \pLog_{\tAbs-1}+\pShk_{\tAbs} \label{eq:pRandomwalk}
    \end{align}
    while for $\posn \in \Die$
    \begin{align}
      \pLog_{\tAbs} & = \pShk_{\tAbs} \label{eq:pStartsAtZero}
    \end{align}
    
  \item Under these assumptions, $\Ex_{\{\Liv_{\tAbs}\}}[\pLev_{\tAbs+1,\posn}]=\Ex_{\{\Liv_{\tAbs}\}}[\pLev_{\tAbs,\posn}\PShk_{\tAbs+1,\posn}]=\pLev_{\tAbs,\posn}$ (where $\Ex_{\{\text{[set]}_{\tAbs}\}}$ denotes the expectation of the value of its argument at the \emph{locations} occupied in period $\tAbs$ for the agents in the set, while  $\Ex[\pLev_{\tAbs,\posn}]$ denotes the expectation across all persons and locations)      
  \item Because dying agents are selected at random, the expectation of $\pLev_{\tAbs,\posn}$ for period-$\tAbs$ survivors must match the expectation of $\pLev_{\tAbs}$ for the entire population:
    \begin{align}
      \Ex_{\{\Liv_{\tAbs}\}}[\pLev_{\tAbs,\posn}]=\Ex[\pLev_{\tAbs,\posn}] \label{eq:pLevLivIsOne}
    \end{align}
    Thus for an economy in which the average value of $\pLev$ is 1 in period $\tAbs$, the population-mean level of $\pLev$ in period $\tAbs+1$ will remain at $1$:
    \together{
      \begin{eqnarray*}
        \Ex[\pLev_{\tAbs+1}] & = & \Die \overbrace{\Ex_{\{\Liv_{\tAbs}\}}[\pLev_{\tAbs,\posn}\PShk_{\tAbs+1,\posn}]}^{\text{survivors have $\pLev=1$}}+(1-\Die)\overbrace{\Ex_{\{\Die_{\tAbs}\}}[1\times\PShk_{\tAbs+1,\posn}]}^{\text{newborns have expected $\pLev=1$}}
        \\ & = & \Die + (1-\Die)
      \end{eqnarray*}}
  \end{enumerate}
  At ${\tp}\FutPer$ we denote the locations occupied by persons who have been alive for exactly $\LooPer$ periods as the set $\{\posn_{{\tp}\FutPer}[\LooPer]\}$. Agents for whom $\LooPer=1$ will have experienced only a single shock, the one at the beginning of the period; for $\LooPer>0$ the agents at those locations (that is, for $\posn \in \{\posn_{{\tp}\FutPer}\}[\LooPer]$),
  \begin{align}
    \pLog_{{\tp}\FutPer,\posn}  & = \sum_{\NewPer=1}^{\LooPer}\pShk_{{\tp}\NewPer,\posn}.
  \end{align}
  For legibility defining $\{\pLog_{{\tp}\FutPer}[\LooPer]\} = \{\pLog_{{\tp}\FutPer,\{\posn_{{\tp}\FutPer}[\LooPer]\}}\}$ as the values of $\pLog$ across the set of agents who in period ${\tp}\FutPer$ have been alive for exactly $\LooPer$ periods, the independence of the $\pShk$'s means that for every $\posn \in \{\posn_{\FutPer}[\LooPer]\}$,
  \begin{align}
    \pLog_{\FutPer,\posn}[\LooPer] \sim \mathcal{N}(\LooPer \pShkMean,\LooPer \sigma^{2}_{\DnsShk}) \label{eq:dstpnm}
  \end{align}
  because such agents have experienced $\LooPer$ IID permanent shocks (recall that the variance of the sum of independent variables is equal to the sum of their variances).

  % expected $\pLog$ is 
  % \begin{eqnarray}
  %   \Ex_{\{\posn_{{\tp}\FutPer}[\LooPer]\}}\left[\sum_{\LooPer=0}^{\FutPer}\pShk_{{\tp}\LooPer,\posn}\right] & = &  \FutPer \pShkMean
  % \end{eqnarray}
  % and this set will have population mass of $\Liv^{\FutPer}$ because death will have diminished the size of the set $\{\posn_{{\tp}\FutPer}[\LooPer]\}$ will have diminished each period at the geometric rate $\Liv$% (after $n$ periods it will be $\Liv^{\FutPer}$ smaller than at entry)
  % .  

  \newcommand{\PDF}{\textrm{PDF}}
  So the PDF of an agent who has been alive for $\LooPer$ periods is the PDF of $\mathcal{N}(\LooPer \pShkMean,\LooPer \sigma^{2}_{\DnsShk}),$
  \begin{align}
    \PDF(\pLog_{\FutPer}[\LooPer]) & = \left(
      % \frac{1}
                                     {\sigma_{\DnsShk}\sqrt{\LooPer 2 \pi}}\right)^{-1} \exp\left(-\frac{(\pLog- \pShkMean \LooPer )^{2}}{2 \LooPer \sigma^{2}_{\DnsShk}}\right)
  \end{align}

  \newpage
  The set of all values of $\pLog$ in period $\FutPer$ will be the union of the $\pLog$'s of persons in the sets of people who have been alive for each possible number of periods (1, for newborns):
  \begin{eqnarray}
    \{\pLog_{\FutPer}\} & = & \bigcup_{\LooPer=1}^{\FutPer}\{\pLog_{\FutPer}[\LooPer]\}
  \end{eqnarray}
  but since each of the individual $\pLog_{\FutPer,\posn}[\LooPer]$ objects is a set of identical gaussians, the set as a whole will be the corresponding gaussian with a weight equal to the size of its population.  The cohort's population mass starts at size $(1-\Liv)$ and shrinks by a factor $\Liv$ each period:
  \begin{align}
    \mass_{\LooPer} & =  (1-\Liv)\Liv^{\LooPer-1} \label{eq:mass}
  \end{align}
  and the total population mass after $\FutPer$ periods is the sum of the masses of the living cohorts:
  \begin{align}
    \Mass_{\FutPer} & =  \sum_{\LooPer=1}^{\FutPer}\mass_{\LooPer}
    \\ & =  (1-\Liv)\sum_{\LooPer=1}^{\FutPer}\Liv^{\NewPer-1}
    \\ & =  (1-\Liv)\left(\frac{1-\Liv^{t}}{1-\Liv}\right)
    \\ & = 1-\Liv^{t}
    % \\ & = \left(\frac{(1+\FutPer)((1+\FutPer)-\Liv(2+\FutPer-\Liv^{\FutPer+1}))}{(1-\Liv)^{2}}\right)
    % \\ & =       \frac{(t+1) \left(-\Lambda  \left(-\Lambda ^{t+1}+t+2\right)+t+1\right)}{(1-\Lambda )^2}
    % \\ & = \frac{(t+1)^2-\frac{\Lambda  \left((t+1) \Lambda ^{t+1}-t-1\right)}{\Lambda -1}}{1-\Lambda }
  \end{align}
  and we use $\wgt$ for the proportion of the population of the population at date $\FutPer$ constituted by agents who have lived $\LooPer$ periods:
  \begin{align}
    \wgt_{\FutPer,\LooPer} & =  \mass_{\LooPer}/\Mass_{\FutPer}
    \\ & = \left(\frac{(1-\Liv)\Liv^{\LooPer-1}}{1-\Liv^{\FutPer}}\right) \label{eq:wgt}
  \end{align}
  For example, in the first period of operation of the economy, $\FutPer=\LooPer=1$ and $\wgt_{\FutPer,\LooPer}=1$.

  Thus $\pLog_{\FutPer}$ is distributed as a weighted sum of gaussians:
  \begin{align}
    \pLog_{\FutPer} & \sim \sum_{\LooPer=1}^{\FutPer}\wgt_{\FutPer,\LooPer}\mathcal{N}(\LooPer \pShkMean,\LooPer \sigma^{2}_{\DnsShk})
  \end{align}
  % whose likelihood is
  % \begin{align}
  %   \PDF_{\tAbs}(\pLog) & = \sum_{\NewPer=1}^{\FutPer} \sum_{\LooPer=1}^{\FutPer}\wgt_{\LooPer}\mathcal{N}(\LooPer \pShkMean,\LooPer \sigma^{2}_{\Psi})
  % \end{align}

  We are finally in a position to derive the results we need.

  The set of values of permanent income at all locations at date $\FutPer,\{\pLog_{\FutPer}\}$, is a weighted collection of normally distributed random variables, with the weights corresponding to the population masses of the cohorts of persons who have lived $\LooPer$ periods given by $\wgt_{\FutPer,\LooPer}$.  The PDF of the entire distribution is the weighted sum of the PDFs of the constituent populations:
  \begin{align}
    \PDF(\pLog_{\FutPer}) & = \frac{\sum _{\LooPer=1}^{\FutPer}
                            \Liv^{\LooPer-1}
                            \exp({-\frac{(\pLog_{\FutPer}-\LooPer \pShkMean )^2}{2
                            \LooPer \sigma ^2}})}{
                            \sigma_{\DnsShk} \sqrt{2 \pi }
                            \underbrace{
                            \sum_{\LooPer=1}^{\FutPer}\Liv^{\LooPer}
                            }_{\left(1-\Liv^{\FutPer}\right)/(1-\Liv)}
                            }
                            % \left[\frac{(1-\Liv)\sum _{\LooPer=1}^{\FutPer} \Liv^{\LooPer-1} \exp\left({-\frac{(\pLog-\pShkMean \LooPer)^2}{2 \LooPer \sigma^2_{\DnsShk}}{\sqrt{2 \pi \sigma_{\DnsShk}  \left(1-\Liv^\FutPer\right)}}\right
  \end{align}

  \section{Simulation Algorithm}

  This describes the simulation algorithm.

  \subsection{A Useful Trick}

  We will repeatedly be using a trick that greatly reduces the number of agents necessary to get well-behaved results.  If there is a normally distributed random variable $\pShk$ that will be drawn for a population of size $\Mass \in \Nteger^{+}$, we first construct the $\Mass-$point equiprobable approximation to the normal distribution, where the probability mass of each element is $1/\Mass$ and the value at location $\posn$ is $\pShk[\posn]$.

  The trick is that, rather than actually drawing a value of $\pShk$ independently for each $\posn$, instead we just randomly reshuffle the order of the elements in $\vctr{\DnsShk}$ (the vector of values of $\pShk$.  In the limit as $\mass \uparrow \infty$ this approaches the asymptote defined by the true distribution.  But in a finite population, we guarantee that the population-mean level and variance of the collection of draws of $\vctr{\DnsShk}$ matches the theoretical values of these objects:
  \begin{align}
    \mu & = (1/\Mass)\sum_{\posn=1}^{\Mass}\pShk_{\posn}
  \end{align}
  \begin{align}
    \sigma^{2}_{\DnsShk} & = (1/\Mass)\sum_{\posn=1}^{\Mass}(\pShk_{\posn} - \mu)^{2}
  \end{align}

  Call a version of $\vctr{\DnsShk}$ that has been reshuffled at date $\tAbs$ $\tilde{\vctr{\DnsShk}}$, and define

  \newcommand{\pShkOldRemix}{\tilde{\vctr{\DnsShk}}_{\Liv}}
  \newcommand{\pShkNewRemix}{\tilde{\vctr{\DnsShk}}_{\Die}}
  \begin{align}
    \pShkOldRemix & = \text{reshuffled $\pShk$ list of size of suvivors} 
    \\  \pShkNewRemix & = \text{reshuffled $\pShk$ list of size of newborns}
  \end{align}

  \subsection{Monte Carlo Simulation Method}

  The first step is to determine how many agents to simulate.

  \newcommand{\popMult}{\Xi}

  We choose a value of $\Die$ so that $1/\Die$ is an integer.  Our population size needs to be at least $\popMult = 3/\Die$ because this guarantees that there will be at least three newborns in the population, which allows us to use the trick above to construct the minimal sensible approximation to a normal distribution - with three points each of which is realized with probability one third.

  To simulate a population that has existed for $\FutPer$ periods, loop over the following steps $\FutPer$ times:
  \begin{enumerate}
  \item Select a random set $\{\Die_{\tAbs}\}$, which corresponds to an integer number $\popMult$ locations; these are the locations at which the agents will be replaced 
  \item For the locations in $\{\Die_{\tAbs}\}$, set the values of $\pLog$ to $\pShkNewRemix$
  \item For the locations in $\{\Liv_{\tAbs}\}$, add to the existing value of $\pLog$ the list of values $\pShkNewRemix$
    \begin{itemize}
    \item Note that in a finite sample, the covariance between $\pLog$ and $\pShkOldRemix$ will not be zero, which means that the sample mean and variance will not be exactly equal to their expectations.
    \end{itemize}
\item Adjust the distribution (see the algorithm for details) so that its mean and variance exactly match the theoretical expectation    
  \end{enumerate}

  \section{Direct Construction of Approximation to Ergodic Distribution}

  With this formula, it is easy to (numerically) construct an approximation to the ergodic distribution of permanent income.

  \section{Discretized Transition Matrix}

  \cite{eaDiscretize} present an admirable analysis of discrete approximations of Markov on continuous state spaces in discrete time.  Notation and setup here follow them.

\mrgn{The setup is identical to \cite{saDiscretize}}
  \subsection{The Continuous-State-Space Problem We Want to Discretize} 
  Consider a discrete time Markov process $\Mrkv$ defined over a continuous state space $\SetFullCnts$ which is characterized by a pair $(\SetFullCnts,\KrnPntNxtFmPntNow_{\pnt})$.  \mrgn{$\KrnPntNxtFmPntNow$ for `transition'} We denote by $(\SetFullCnts,\Borel(\SetFullCnts),\PrbFullCnts)$ the probability structure on $\SetFullCnts$, with $\Borel(\SetFullCnts)$ being the associated $\sigma-$algebra, and $\PrbFullCnts$ is a probability measure to be defined shortly. $\KrnPntNxtFmPntNow_{\pnt}$ is a conditional stochastic kernel \mrgn{`stochastic kernel': valid pty description} that assigns to each point $\pnt \in \SetFullCnts$ a probability measure $\KrnPntNxtFmPntNow_{\pnt}(\bullet|\pnt)$ so that for any measurable set $\SetPartCnts \in \Borel(\SetFullCnts), \PrbFullCnts(\pnt(1) \in \SetPartCnts|\pnt(0)=\pnt) \equiv \int_{\SetPartCnts}\KrnPntNxtFmPntNow_{\pnt}(d\Nxt{\pnt}|\pnt)$ ($\pnt(1)$ is at date 1 while $\pnt(0)$ is at date 0).\mrgn{$\KrnPntNxtFmPntNow$ maps from a particular point at $\tAbs$ to any set of points (`event') at $\tAbs+1$.}  We assume that the stochastic kernel $\KrnPntNxtFmPntNow$ admits a density function $\DnsPntNxtFmPntNow_{\pnt}$, namely $\KrnPntNxtFmPntNow_{\pnt}(d\Nxt{\pnt}|\pnt) = \DnsPntNxtFmPntNow_{\pnt}(\Nxt{\pnt}|\pnt)d\Nxt{\pnt}$.
  % That is, (1) $\SetPartCnts$ is bounded and (2) $\KrnPntNxtFmPntNow$ is the CDF

  The initial state of the Markov process $\Mrkv$ is random \mrgn{Could be deterministic instead} and distributed according to the density function $\DnsPnt_{0} : \SetFullCnts \rightarrow \reals^{\geq 0}$.  The state distribution of $\Mrkv$ at time $\tAbs \in \Nteger \doteq  \{1,2,3,...\}$ is characterized by a density function $\DnsPnt_{\tAbs} : \mathcal{\SetFullCnts} \rightarrow \reals^{\geq 0}$ such that for all $\SetPartCnts \in \Borel({\SetFullCnts}),$\mrgn{For all measurable sets, there is a measurable probability of any specific sequence of events leading up to $\tAbs$}
  \begin{align}
    \PrbEvntSqnc(\pnt(\tAbs) \in \SetPartCnts) & \equiv \int_{\SetPartCnts} \DnsPnt_{\tAbs}(\pnt)d\pnt
  \end{align}
  where $\PrbEvntSqnc$ indicates the probability associated to events over the product space\mrgn{combine $(\tAbs+1)$ of $\SetFullCnts$} $\SetFullCnts^{\tAbs+1}$ with elements $\vctr{\pnt}=[\pnt(0),\pnt(1),{\dots},\pnt(\tAbs)]$, where $\vctr{\pnt}$ indicates a vector of individual values of $\pnt$ (the same notation applies below).

  The state density functions $\DnsPnt_{\tAbs}(\bullet)$ can be computed recursively:\mrgn{prb of $\pnt_{\tAbs+1}$: sum of ways to get there from all $\pnt_{t}$}
  \begin{align}
    \DnsPnt_{\tAbs+1}(\Nxt{\pnt}) &= \int_{\SetFullCnts} \DnsPntNxtFmPntNow_{\pnt}(\Nxt{\pnt}|\pnt)\DnsPnt_{\tAbs}(\pnt)d\pnt ~~~~ \forall~\Nxt{\pnt} \in \SetFullCnts \label{eq:stateDensity}
  \end{align}

  We make further assumptions that correspond to Assumptions 1 and 2 in \cite{saDiscretize}, with the result that their Theorem 3 holds:
  \begin{comment} % Just say assumptions are the same as in 
  \textbf{Assumption \ref{assn:Bounded}} For given sets $\KrnPntNxtFmPntNowSetSprtTrnc \subset \SetFullCnts^{2}$ and $\SetTrncCnts_{0} \subset \SetFullCnts$, there exist positive constants $\epsilon$ and $\epsilon_{0}$, such that $\DnsPntNxtFmPntNow_{\pnt}(\Nxt{\pnt}|\pnt) $ and $\DnsPnt_{0}(\pnt)$ satisfy the following conditions:

  \begin{align}
    \DnsPntNxtFmPntNow_{\pnt}(\Nxt{\pnt}|\pnt) \leq \epsilon ~~~~\forall(\pnt,\Nxt{\pnt})~\in~\SetFullCnts \backslash \KrnPntNxtFmPntNowSetSprtTrnc, \text{~and~} \DnsPnt_{0}(\pnt) \leq \epsilon_{0}
  \end{align}

  \textbf{Assumption \ref{assn:Lipschitz}} see \cite{eaDiscretize} Assumption 2.
\end{comment}

  \textbf{Theorem 3}: \textit{The functions $\DnsPnt_{\tAbs}(\bullet)$ can  be approximated by piecewise constant functions $\DnsPntAprx(\bullet)$, defined as}
  \begin{align}\label{eq:PrbBinNxtFmPntNow}
    \DnsPntAprx_{\tAbs}(\pnt) &= \sum_{\LoopC=1}^{\NumAprxStes} \frac{\PrbBinNxtFmPntNow_{\tAbs}(\LoopC)}{\Lebes(\SetPartCnts_{\LoopC})} \mathbb{I}_{\SetPartCnts_{\LoopC}}(\pnt)~~~~\forall~\tAbs~\in~\Nteger^{+}
  \end{align}\mrgn{Every $\pnt$ in $\SetPartCnts_{k}$ has same pty $\DnsPntAprx_{k}$}where $\mathbb{I}_{\SetPartCnts}(\bullet)$ is the indicator function of a set $\SetPartCnts \subseteq \SetFullCnts$ (that is, $\mathbb{I}_{\SetPartCnts}(\pnt) = 1$ if $\pnt \in \SetPartCnts$; else $\mathbb{I}_{\SetPartCnts}(\pnt) = 0$).  % The approximation error is upper-bounded by  ... [boring details]


  We consider a finite Markov chain $\Mrkv_{f}$ with $n+1$ discrete abstract states over this space characterized by the transition probability matrix $\TnsMrkv = [\TnsMrkv_{\thisBin\thatBin}]$ where the probability of jumping from state $\thisBin$ to state $\thatBin$ $(\TnsMrkv_{\thisBin,\thatBin})$ is computed as:\mrgn{In the case of an unbounded state space, this captures the probability mass of all values of $\pnt$ not encompassed in $\SetPartCnts$ - values above or below the cutoff values that defined $\SetPartCnts$ as a bounded subset of the original unbounded space}
  \begin{align}
    \TnsMrkv_{\thisBin,\thatBin} &= \left(\frac{1}{\Lebes(\SetPartCnts_{\thisBin})}\right)\int_{\SetPartCnts_{\thisBin}}\left(\int_{\SetPartCnts_{\thatBin}}\DnsPntNxtFmPntNow_{\pnt}(\Nxt{\pnt}|\pnt){d\Nxt{\pnt}}\right){d\pnt}~~~\forall\thatBin \in~ \Nteger_{\NumAprxStes} \label{eq:thisTOthat}
    \\ \TnsMrkv_{\NumAprxStesPls,\thisBin} &= \delta_{\NumAprxStesPls,\thisBin}\notag
  \end{align}{\mrgn{Reversed the order of integration here; $\thatBin$ first, then $\thisBin$}}
  
\noindent for all $\thatBin \in \Nteger_{\NumAprxStesPls}$, and where $\delta_{\NumAprxStesPls,\thatBin}$ is the Kronecker delta function (the abstract state $\NumAprxStesPls$ of $\Mrkv_{f}$ is absorbing) 
  and $\Lebes(\bullet)$ denotes the Lebesgue measure of a set.\footnote{If there are any point masses in the set, they are captured as a case where $\Bot{\SetPartCnts}=\Top{\SetPartCnts}$; that is, all point masses are allocated an ``interval'' of measure zero at the location of the point mass.}

  The initial distribution of $\Mrkv_{f}$ is the probability mass function (\pmf) $~\vctr{\PrbBinNxtFmPntNow}_{0} = [\PrbBinNxtFmPntNow_{0}(1),\PrbBinNxtFmPntNow_{0}(2),\dots,\PrbBinNxtFmPntNow_{0}\NumAprxStesPls]$ obtained from $\DnsPnt_{0}$ as the average value of $\PrbBinNxtFmPntNow_{0}$ in each of the $\thisBin$ intervals: $\PrbBinNxtFmPntNow_{0}(\thisBin)=\int_{\SetPartCnts_{\thisBin}} \DnsPnt_{0}(\pnt)d\pnt ,~\forall~\thisBin~\in~\Nteger_{\NumAprxStes}$.\footnote{If there is a point mass at $\SetPartCnts_{\thisBin}$, $\PrbBinNxtFmPntNow_{0}(\thisBin)=\int_{\SetPartCnts_\thisBin}\delta(\thisBin) \DnsPnt_{0,\thisBin}=\PrbEvntSqnc_{0}(\pnt)>0$ where $\delta$ is the Dirac $\delta$).}   Under \cite{eaDiscretize}'s further assumptions, the {\pmf} associated to the state distribution of $\Mrkv_{f}$ at time $\tAbs \in \Nteger \dot{=} \{1,2,3,...\}$ can be computed as $\vctr{\PrbBinNxtFmPntNow}_{\tAbs}=\vctr{\PrbBinNxtFmPntNow}_{0}\TnsMrkv^{\tAbs}$.  $\vctr{\PrbBinNxtFmPntNow}_{\tAbs}$ is used to construct an approximation function, denoted by $\DnsPntAprx_{\tAbs}$, of the density function $\DnsPnt_{\tAbs}$, where $\DnsPntAprx_{\tAbs}$ is a piecewise constant approximation (with values that are the entries of the {\pmf}~$\vctr{\PrbBinNxtFmPntNow}_{\tAbs}$ normalized by the Lebesgue measure of the associated partition set) of the original density function $\DnsPnt_{\tAbs}.$  %Continuity of $\DnsPnt_{\tAbs}$ enables the quantification of the error of its piecewise constant approximation.

    \section{Permanent Income Shocks}
  % Suppose we have an equiprobable discretized representation of the distribution of $\pLev$.  Specifically, we have a finite Markov chain $\Mrkv_{f}$ with $\NumAprxStes + 1$ discrete states in the set $\Nteger_{\NumAprxStesPls} \doteq \{1,2,\dots,\NumAprxStes,\NumAprxStesPls\}$ %% Hard to figure out what $\doteq$ means here.  Usually it means the same thing as $\approx$ but here perhaps it indicates mean convergence: https://www.physicsforums.com/threads/equals-signs-meanings.62275/#js-post-554589
  % and characterized by the transition probability matrix $\TnsMrkv = [\TnsMrkv_{\thisBin,\thatBin}]~\in~\reals^{\NumAprxStesPls^{2}}$ where

  We now adapt the foregoing to the case of calculating an approximation to the steady state distribution of permanent income. We specialize the space $\SetFullCnts$ to contain points on the real number line so that for all $\pnt \in \SetFullCnts$, $\pnt \in \reals$.

  Suppose we have partitioned the space into a set of $\NumAprxStesPls$ successive intervals indexed by $\thisBin$ such that $\thisBin \in \Nteger_{\NumAprxStesPls} \doteq \{1,2,\dots,\NumAprxStes,\NumAprxStesPls\}$, whose boundaries are given by $\{\Bot{\SetPartCnts}_{\thisBin},\Top{\SetPartCnts}_{\thisBin}\}$ where $\Bot{\SetPartCnts}_{1}$ is the lower bound of the space $\SetPartCnts$ and $\Top{\SetPartCnts}_{\NumAprxStes}$ is the upper bound, and the upper bound of $\SetPartCnts_{\thisBin}$ is the lower bound of $\SetPartCnts_{\thisBin+1}$ (that is, $\Top{\SetPartCnts}_{\thisBin}=\Bot{\SetPartCnts}_{\thisBin+1}$).  The set $\SetPartCnts_{\thisBin}$ therefore contains all  $\pnt \in [\Bot{\SetPartCnts}_{\thisBin},\Bot{\SetPartCnts}_{\thisBin+1})$,\mrgn{Leaves any point mass at $\Top{\SetPartCnts}_{\thisBin}$ in $\thisBin+1$} and $\SetPartCnts_{\NumAprxStesPls}$ is the mass of points (if any) excluded by the bounding process.
  
  We now have the notation to describe our discrete approximation to the distribution of the level of permanent income $\pLev$.  %Suppose we have already obtained an equiprobable representation of the steady state distribution.


  % That is for some $\NumAprxStes$ we have found a distribution in which $\Lebes(\DnsPntAprx_{\thisBin})=1/\NumAprxStes~\forall~\thisBin \in \NumAprxStes$.

  Per \eqref{eq:thisTOthat}, we can calculate the transition probabilities from:
  \begin{align}
    \TnsMrkv_{\thisBin,\thatBin} &= \left(\frac{1}{\underbrace{\Lebes(\SetPartCnts_{\thisBin})}_{\SetPartCnts_{\thisBin}\text{~Pop mass}}}\right)\overbrace{\int_{\SetPartCnts_{\thisBin}}}^{\pnt\in[\Bot{\SetPartCnts}_{\thisBin},\Top{\SetPartCnts}_{\thisBin})}\left(\underbrace{\overbrace{\int_{\SetPartCnts_{\thatBin}}}^{\Nxt{\pnt}\in[\Bot{\SetPartCnts}_{\thatBin},\Top{\SetPartCnts}_{\thatBin})}\DnsPntNxtFmPntNow_{\pnt}(\Nxt{\pnt}|\pnt){d\Nxt{\pnt}}}_{\equiv \Nxt{\PrbBinNxtFmPntNow}(\thatBin|\pnt)} \right){d\pnt}~~~\forall\thisBin\in\Nteger_{\NumAprxStes} \label{eq:thispTOthatp}
  \end{align}
  where $\Nxt{\PrbBinNxtFmPntNow}(\thatBin|\pnt)$ is the probability mass for being in interval $\thatBin$ next period, given that you are at point $\pnt$ this period.

  Defining $\CDF^{\bullet}$ as the cumulative distribution function of $\bullet$, now recall from \eqref{eq:pRandomwalk} that for $\pnt \in \Liv_{\tAbs+1}$ (locations where the occupant survives),
  \begin{align}
    \Nxt{\pnt} & = \pnt+\pShk
  \end{align}
  so
  \begin{align}
    \DnsPntNxtFmPntNow_{\pnt}(\Nxt{\pnt}|\pnt, \Nxt{\pnt} \in \Liv_{\tAbs+1}) &=  d{\CDF^{\DnsShk}(\Nxt{\pnt}-\pnt)}.
  \end{align}
  In words: To get from $\pnt$ to $\Nxt{\pnt}$ requires a shock of size $\pShk = \Nxt{\pnt}-\pnt$ whose probability density is measured by $d\CDF^{\DnsShk}(\Nxt{\pnt}-\pnt)$.
  For a given $\pnt$ the probability mass for the set of draws of $\pShk$ that put you in $\SetPartCnts_{\thatBin}$ is therefore:
  \newcommand{\erf}{\text{erf}}
  \begin{align}
    \Nxt{\PrbBinNxtFmPntNowAprx}(\thatBin|\pnt,\Nxt{\pnt}\in\Liv_{\tAbs+1})  &= \int_{\Bot{\SetPartCnts}_{\thatBin}-\pnt}^{\Top{\SetPartCnts}_{\thatBin}-\pnt} d{\CDF^{\DnsShk}}
    \\ & = \CDF^{\DnsShk}(\Top{\SetPartCnts}_{\thatBin}-\pnt)-\CDF^{\DnsShk}(\Bot{\SetPartCnts}_{\thatBin}-\pnt) \notag
  \end{align}
  For locations whose occupant is replaced, the calculation is even simpler.  At those locations, permanent income is reset to its starting value of 0 and then a shock is drawn, so
  \begin{align}
    \Nxt{\pnt} &= \pShk
  \end{align}
  so
  \renewcommand{\Die}{(1-\Liv)}
  \begin{align}
    \Nxt{\PrbBinNxtFmPntNowAprx}(\thatBin|\pnt,\Nxt{\pnt}\notin\Liv_{\tAbs+1})  &= \int_{\Bot{\SetPartCnts}_{\thatBin}}^{\Top{\SetPartCnts}_{\thatBin}} d{\CDF^{\DnsShk}}
    \\ & = \CDF^{\DnsShk}(\Top{\SetPartCnts}_{\thatBin})-\CDF^{\DnsShk}(\Bot{\SetPartCnts}_{\thatBin}) \notag
  \end{align}
  so the unconditional transition process is a weighted mixture of the two distributions:
  \begin{align}
    \Nxt{\PrbBinNxtFmPntNowAprx}(\thatBin|\pnt)  &= \Liv\Nxt{\PrbBinNxtFmPntNowAprx}(\thatBin|\pnt,\Nxt{\pnt}\in\Liv_{\tAbs+1}) + (1-\Liv)    \Nxt{\PrbBinNxtFmPntNowAprx}(\thatBin|\pnt,\Nxt{\pnt}\notin\Liv_{\tAbs+1}).
  \end{align}
  

  The overall transition probability structure is therefore 
  \begin{align}
    \TnsMrkv_{\thisBin,\thatBin}& = \left(\frac{1}{\Lebes(\SetPartCnts_{\thisBin})}\right)  \int_{\Bot{\SetPartCnts}_{\thisBin}}^{\Top{\SetPartCnts}_{\thisBin}} \Nxt{\PrbBinNxtFmPntNow}(\thatBin|\pnt) d\CDF^{\DnsPnt_{\tAbs}}(\pnt)
\\ & = \left(\frac{1}{\Lebes(\SetPartCnts_{\thisBin})}\right)  \int_{\Bot{\SetPartCnts}_{\thisBin}}^{\Top{\SetPartCnts}_{\thisBin}} \Nxt{\PrbBinNxtFmPntNowAprx}(\thatBin|\pnt) d\CDF^{\DnsPntAprx_{\tAbs}}(\pnt)                              .
  \end{align}

  The idea here is that we are replacing the respective set of shocks that would be sufficient, in the continuous state space, to move from each point in any partition $\thisBin$ to some point in partition $\thatBin$ (weighted by each shock's probability) by, in the discretized state space, a single shock with that same probability that moves the (now assumed to be identical) occupants of discrete bin ${\thisBin}$ to discrete bin ${\thatBin}$.

  \subsection{Intervals}

  There are many possible ways of choosing the set of intervals $\SetPartCnts_{\thisBin}$.  A particularly transparent choice is the equiprobable case: The intervals are chosen so that in the steady state there should be an equal population mass in each interval.  If we have the ``true'' CDF of the limiting distribution $\CDF^{\pLog}$ then we can define:

  Define a set of points from $\sharp_{0}$ to $\sharp_{\NumAprxStes}$ on the $[0,1]$ interval as the elements of the set $\sharp = \{0,1/\NumAprxStes,2/\NumAprxStes, \ldots,1\}$.\footnote{These points define intervals that constitute a partition of the domain of $\CDF^{\pLog}$.}  Call the inverse of the $\pLog$ distribution $(\CDF^{\pLog})^{-1}$, and define the points $\pnt_{\thisBin} = (\CDF^{\pLog})^{-1}(\sharp_{\thisBin})$.  Then the conditional mean of $\pLog$ in each of the intervals numbered 1 to $\NumAprxStes$ is:
\begin{eqnarray}
        \pLog_{\thisBin} \equiv \Ex[\pLog | \sharp_{\thisBin-1}^{-1} \leq \pLog < \sharp_{\thisBin}^{-1}] & = & \int_{\Bot{\SetPartCnts}_{\thisBin}}^{\Top{\SetPartCnts}_{\thisBin}} \pLog ~ d\CDF^{\pLog}(\pLog)
\end{eqnarray}


  \subsection{What Exactly Are We Approximating?}

  In the original, truly-continuous-state-space economy, the homotheticity of the problem allowed us to eliminate a state variable by dividing the problem by the level of permanent income.  This required that the anticipated distribution of the shocks to (log) permanent income be identical no matter what the consumer's level of permanent income.

  In our approximation, however, the size of the jump in $\pnt$ cannot be independent of the level of $\pnt$.  This is most obvious at the outermost bins of the distribution: It is not possible to jump to a level of permanent income that is lower than the lowest bin, or higher than the highest bin, while those two possibilities are equally likely for the point at the midpoint of the $\CDF$.  

  There are two possible interpretations of what we are doing:
  \begin{itemize}
  \item We are modeling a `true' economy in which, in truth, the magnitude of the permanent shocks is independent of their level
  \item We are imagining that we have moved the population of the true economy to a new and different economy that follows the structure we have derived as an approximation to the true economy
  \end{itemize}

  In the former case, we think of our model consumers as actually living in the true economy.  Their expectations, and the ``true'' evolution of the population, reflect the homotheticity/scaling assumptions we made earlier.  In the latter case, consumers would need to keep track of their permanent income as a state variable, because the true characteristics of the shocks they would experience would depend on the level of their permanent income.

  \pagebreak

  \provideboolean{notaBuff}
  \setboolean{notaBuff}{true}
  % \setboolean{notaBuff}{false}

  \ifthenelse{\boolean{notaBuff}}{
    \renewcommand{\SetPartCnts}{\mu}
    \renewcommand{\Nxt}{\grave}
    \renewcommand{\pnt}{\aRat}
    \renewcommand{\DnsPntAprx}{\alpha}
  }{}
  \section{Markov Transition for $\aRat$}

  \begin{comment}
    Our derivations will be for consumers who are living in the `true' economy.  In that economy, the transition equation for $\aRat$ is:
    \subsection{Transition for $\aRat$}
    \begin{align}
      \aRat_{\tAbs+1} & = \Rfree (\PGro \pShk_{\tAbs+1})^{-1} \aRat_{\tAbs} + \tShk_{\tAbs+1} - \cFunc_{\tAbs+1}(\Rfree (\PGro \pShk_{\tAbs+1})^{-1}\aRat_{\tAbs}+\tShk_{\tAbs+1})
      \\                \Nxt{_{\tAbs+1}^{\aRat}(\aRat_{\tAbs+1}) & = \CDF_{\tAbs+1}^{\aRat}\left(\Rfree (\PGro \pShk_{\tAbs+1})^{-1} \aRat_{\tAbs} + \tShk_{\tAbs+1} - \cFunc_{\tAbs+1}(\Rfree (\PGro \pShk_{\tAbs+1})^{-1}\aRat_{\tAbs}+\tShk_{\tAbs+1})\right)
    \end{align}
  \end{comment}

  Designating a next-period variable $\bullet$ by $\Nxt{\bullet}$, for a person who ends the current period with assets $\pnt$, market resources at the beginning of the next period will be
  \begin{align}
    \Nxt{\mRat} & = \Nxt{\Rnorm}\pnt+\Nxt{\tShk}.
  \end{align}
  We assume that we have found converged consumption and asset functions $\aFunc(\mRat)=\mRat-\cFunc(\mRat)$.  
  
Now we want to calculate the discrete Markov approximation to the true continuous evolution of the economy. 
  \begin{align}
    \Nxt{\pnt} & = \aFunc(\Nxt{\Rnorm} \pnt + \Nxt{\tShk})
    % \\                \DnsPnt(\Nxt{\pnt}) & = \int_{\SetPartCnts}\left(\DnsPnt(\pnt)\left(\Nxt{\Rnorm} \pnt + \Nxt{\tShk} - \cFunc(\Nxt{\Rnorm}\pnt+\Nxt{\tShk})\right)\right) d\pnt
  \end{align}
  % and the state density function analogous to \eqref{eq:stateDensity} is:

  % \renewcommand{\pnt}{\aRat}

  The period-$\tAbs$ distribution of $\Mrkv_{f}$ is defined by a probability mass function (\pmf)$~\vctr{\PrbBinNxtFmPntNow}_{\tAbs} = [\PrbBinNxtFmPntNow_{\tAbs}(1),\PrbBinNxtFmPntNow_{\tAbs}(2),\dots,\PrbBinNxtFmPntNow_{\tAbs}\NumAprxStesPls]$.\footnote{If the consumption rule has a target $\Target{\aRat}$, a natural starting point is to have all of the population mass at $\Target{\aRat}$.}  The transition matrix is 
  \begin{align}
    \TnsMrkv_{\thisBin,\thatBin} &= \left(\frac{1}{\Lebes(\SetPartCnts_{\thisBin})}\right)\overbrace{\int_{\SetPartCnts_{\thisBin}}}^{\pnt\in[\Bot{\SetPartCnts}_{\thisBin},\Top{\SetPartCnts}_{\thisBin})}\underbrace{\overbrace{\int_{\SetPartCnts_{\thatBin}}}^{\Nxt{\pnt}\in[\Bot{\SetPartCnts}_{\thatBin},\Top{\SetPartCnts}_{\thatBin})}\DnsPntNxtFmPntNow_{\pnt}(\Nxt{\pnt}|\pnt){d\Nxt{\pnt}}}_{\equiv \Nxt{\PrbBinNxtFmPntNow}(\thatBin|\pnt)} {d\pnt}~~~\forall\thisBin\in\Nteger_{\NumAprxStes} \label{eq:thispTOthatp}
  \end{align}
  where $\Nxt{\PrbBinNxtFmPntNow}(\thatBin|\pnt)$ is the probability of being in interval $\thatBin$ next period, given that you are at point $\pnt$ this period.
  The only structural difference with the case above is that the transition function $\DnsPntNxtFmPntNow_{\pnt}$ now depends on two shocks, $\Nxt{\DnsShk}$ and $\Nxt{\tShk}$, instead of just one ($\Nxt{\DnsShk}$).

  \begin{comment}
    Equation \eqref{eq:stateDensity} translates to
    \begin{align}
      \DnsPnt_{\tAbs+1}(\Nxt{\pnt}) &= \int_{\SetFullCnts} \DnsPntNxtFmPntNow_{\pnt}(\Nxt{\pnt}|\pnt)\DnsPnt_{\tAbs}(\pnt)d\pnt ~~~~ \forall~\Nxt{\pnt} \in \SetFullCnts \label{eq:stateDensity}
    \end{align}
  \end{comment}

  We now want to inspect $\Nxt{\PrbBinNxtFmPntNow}(\thatBin|\pnt)$ more closely:
  \begin{align}
    \Nxt{\PrbBinNxtFmPntNowAprx}(\thatBin|\pnt) &=   \int_{\Bot{\SetPartCnts}_{\thatBin}}^{\Top{\SetPartCnts}_{\thatBin}}\DnsPntNxtFmPntNow_{\pnt}(\Nxt{\pnt}|\pnt) d\Nxt{\pnt}
    % \\ & =  \int_{\Bot{\SetPartCnts}_{\thatBin}}^{\Top{\SetPartCnts}_{\thatBin}}                                     \left(\Nxt{\Rnorm} \aRat + \Nxt{\tShk} - \cFunc(\Nxt{\Rnorm}\aRat+\Nxt{\tShk})\right)\DnsPnt_{\tAbs}(\pnt)d\pnt
  \end{align}

  In words, we integrate over the combinations of realizations of $\Nxt{\DnsShk}$ and $\Nxt{\tShk}$ such that, if we start at $\pnt$, $\Nxt{\pnt} \in \SetPartCnts_{j}$.  For the moment, let's take $\Nxt{\Rnorm}$ as fixed and consider which values of $\tShk$ would lead to some $\Nxt{\pnt} \in \SetPartCnts_{\thatBin}$. Because $\aFunc(\bullet)$ is not an analytical function, for any $\Nxt{\Rnorm}(\pShk)$ (equivalently, for any $\pShk$) we must search numerically for the $\{\Bot{\Nxt{\tShk}}(\pnt,\pShk,\thatBin),\Top{\Nxt{\tShk}}(\pnt,\pShk,\thatBin)\}$ such that $\Nxt{\pnt}$ arrives respectively at $\{\Bot{\SetPartCnts}_{\thatBin},\Top{\SetPartCnts}_{\thatBin}\}$.\footnote{See the appendix for a sketch of a procedure for doing this.}

  % Defining the functions that return the minimum and maximum realization of $\tShk$ such that $\Nxt{\pnt} \in \SetPartCnts_{\thatBin}$ as $\Bot{\tShk}(\pShk,\thatBin)$  and $\Top{\tShk}(\pShk,\thatBin)$, the

  Various characteristics of the $\aFunc$ function (continuity; monotonicity; concavity; limits) mean that $\Nxt{\pnt}$ is monotonically increasing in $\tShk$, so the {\pmf} $\Nxt{\PrbBinNxtFmPntNow}(\thatBin|\pnt)$  for arriving in state $\thatBin$ as a function of $\pShk$ is simply:
  \begin{align}
    \Nxt{\PrbBinNxtFmPntNow}(\thatBin|\pnt,\Nxt{\DnsShk}) & = \CDF^{\tShk}(\Top{\tShk}(\thatBin|\pnt,\Nxt{\DnsShk}))-\CDF^{\tShk}(\Bot{\tShk}(\thatBin|\pnt,\Nxt{\DnsShk})).
  \end{align}
  so the probability mass for arrival in $\thatBin$ is
  \begin{align}
    \Nxt{\PrbBinNxtFmPntNow}(\thatBin | \pnt) & = \int_{\Bot{\DnsShk}}^{\Top{\DnsShk}} \Nxt{\PrbBinNxtFmPntNow}(\thatBin|\pnt,\Nxt{\DnsShk}) d\CDF^{\Nxt{\DnsShk}}
  \end{align}

  We now have the {\pmf} of $\SetPartCnts_{\thatBin}$ for any fixed $\pnt$,\footnote{We are assuming that $\log \tShk \sim \mathcal{N}(\mu,\sigma^{2})$, so we can use the fact that:
    $\CDF^{\tShk}(\tShk) = \frac{1}{2}\left(1+\erf\left(\frac{\tShk-\mu}{\sigma \sqrt{2}}\right)\right)$
  } so in order to calculate the probability of arriving in $\SetPartCnts_\thatBin$ from any point in $\SetPartCnts_\thisBin$ all we need to do is integrate the conditional probability over all possible values of $\pnt \in \SetPartCnts_{\thisBin}$:
  \begin{align}
    \TnsMrkv_{\thisBin,\thatBin} &=\left(\frac{1}{\Lebes(\SetPartCnts_{\thisBin})}\right) \int_{\Bot{\SetPartCnts}_{\thisBin}}^{\Top{\SetPartCnts}_\thisBin} \Nxt{\PrbBinNxtFmPntNow}(\thatBin|\pnt) d\CDF^{\pnt}. \label{eq:PTrns}
  \end{align}

  Our approximation scheme relies upon the substitution, for each $\pnt \in \SetPartCnts_{i}$ a point that is the weighted mean, $\hat{\pnt}_{\thisBin} = \int_{\SetPartCnts_{i}}\pnt d\CDF^{\pnt}$.  But without having the CDF $\CDF$ of the continuous distribution, we have no way to compute these values.

  Fortunately, \cite{eaDiscretize} describe a recursive procedure that is guaranteed to result in bounded errors.

  \textit{\textbf{Theorem 1}}. The functions $\DnsPnt_{\tAbs}$ satisfy the bound\mrgn{$\DnsPnt$ is small for $\pnt$ in $\SetFullCnts$ that are excluded from $\SetTrncCnts$}
  \begin{align}
    0 & \leq \DnsPnt_{\tAbs}(\pnt) \leq \varepsilon_{\tAbs}~~~~\forall \pnt \in \SetFullCnts \backslash \SetTrncCnts_{\tAbs}
  \end{align}\mrgn{bounds grow as you go farther and farther}
\noindent where the quantities $\{\varepsilon_{\tAbs}\}_{\tAbs=0}^{N}$ are defined recursively by
  \begin{align}
    \varepsilon_{\tAbs+1} &= \epsilon + \mathrm{M}_{f}\varepsilon_{\tAbs},
  \end{align}
  whereas the support sets $\{\SetTrncCnts\}_{\tAbs=0}^{N}$ are computed as\mrgn{You expand the size of the support}
  \begin{align}
    \SetTrncCnts_{\tAbs+1} &= \Pi_{\Nxt{\pnt}}\left(\KrnPntNxtFmPntNowSetSprtTrnc \cap (\SetTrncCnts \times \SetFullCnts)\right)
  \end{align}
  where $\Pi_{\Nxt{\pnt}}$ denotes the projection map along the second set of coordinates.\mrgn{By the amount given by the outcomes of the stochastic shocks}
  This means that we can start with an arbitrary distribution, and if we iterate long enough we can construct support sets that are large enough to guarantee the errors are bounded arbitrarily tightly.

  Concretely, what we do is to begin with a support set $\SetTrncCnts_{0}$ defined by the bounds of our discretization of the shock process. Concretely, we construct $\SetTrncCnts_{0}$ as $\pnt \in [\Bot{\tShk}-\tShkMean,\Top{\tShk}-\tShkMean]$ with {\pmf} identical to the $\pmf$ of the shock $\tShk$.  Then we proceed by continuing to expand.  That is, each of the nodes in $\SetTrncCnts_{0}$ yields an array of other points as that location experiences the full distribution of outcomes from the discretized process.  So, for instance, the bottommost point in $\SetTrncCnts_{1}$ will match the result of having twice drawn the worst possible realization of the shock.  We iterate for enough periods that we judge to give a wide enough dispersion of points for the final approximation, then stop.

  

  \begin{comment}

    \begin{align}
      % & =    \int_{\underline{\Nxt{\pnt}}_{\thisBin}}^{\bar{\Nxt{\pnt}}_{\thisBin}}\left(\Nxt{\Rnorm} \pnt + \Nxt{\tShk} - \cFunc_{\tAbs+1}(\Nxt{\Rnorm}\pnt+\Nxt{\tShk})\right) d{\CDF(\tShk)}
      % \\ & = \CDF^{\tShk}(\Top{\SetPartCnts}_{\thisBin}-\Bot{\SetPartCnts}_{\thisBin})-\CDF^{\tShk}(\Bot{\SetPartCnts}_{\thisBin}-\Bot{\SetPartCnts}_{\thisBin})
           & = \left(\frac{1}{2}\right)\left(\erf(\Top{\SetPartCnts}_{\thisBin}-\Bot{\SetPartCnts}_{\thisBin})-\erf(\Bot{\SetPartCnts}_{\thisBin}-\Bot{\SetPartCnts}_{\thisBin})\right)
    \end{align}
  \end{comment}

  \begin{comment}
    Finally, for $a < b$ defining 
    \begin{align}
      \mathfrak{C}(a,b) & \equiv  \CDF^{\tShk}(b)-\CDF^{\tShk}(a)
    \end{align}

    so
    \begin{align}
      \TnsMrkv_{\thisBin,\thatBin} &= \int_{\Bot{\SetPartCnts}_{\thisBin}}^{\Top{\SetPartCnts}_{\thisBin}} \mathfrak{C}(\pnt-\underline{\pnt}_{\thatBin},\pnt-\bar{\pnt}_{\thatBin})d\CDF^{\pnt}
    \end{align}
  \end{comment}

  \section{Backwards}

  \newcommand{\last}{\mathsf{T}}
  We now consider an economy in which there is a last period $\last$.

  The main thing that makes this problem different from the former one is that the consumption function now depends on time, $\aFunc_{\tAbs}$.  In the last period $\aFunc_{\last}(\mRat) = 0$, and for prior periods it will be obtained by solving the dynamic stochastic optimization problem.

  Assuming that the distribution of the shocks does not change with the time period, 
  \begin{align}
    \TnsMrkv_{\thisBin,\thatBin}[\tAbs] &= \int_{\Bot{\SetPartCnts}_{\thisBin}}^{\Top{\SetPartCnts}_{\thisBin}} \Nxt{\PrbBinNxtFmPntNow}[\tAbs](\thatBin|\pnt) d\CDF^{\pnt}_{\tAbs}
  \end{align}

  Rewriting \eqref{eq:aThisThat}
  \begin{align}
    \pnt_{\tAbs+1} & = \aFunc_{\tAbs+1}(\Rnorm_{\tAbs+1} \pnt_{\tAbs} + \tShk_{\tAbs+1})
  \end{align}
  we again must solve numerically for $\Top{\tShk}[\tAbs](\thatBin|\pnt_{\tAbs},\pShk_{\tAbs+1})$ and $\Bot{\tShk}[\tAbs](\thatBin|\pnt_{\tAbs},\pShk_{\tAbs+1})$ functions, which will now yield a
  \begin{align}
    \Nxt{\PrbBinNxtFmPntNow}[\tAbs](\thatBin|\pnt_{\tAbs},\pShk_{\tAbs+1}) & = \CDF^{\tShk}(\Top{\tShk}[\tAbs](\thatBin|\pnt_{\tAbs},\pShk_{\tAbs+1}))-\CDF^{\tShk}(\Bot{\tShk}[\tAbs](\thatBin|\pnt_{\tAbs},\pShk_{\tAbs+1})),
  \end{align}
  and the formula for $\Nxt{\PrbBinNxtFmPntNow}$ is again given by \eqref{eq:}

  \begin{comment} % Already produced this formula above 
    We now have the {\pmf} of $\SetPartCnts_{\thatBin}$ for any fixed $\pnt_{\tAbs}$, so all we need to do is integrate over all possible values of $\pnt_{\tAbs} \in \SetPartCnts_{\thisBin}$:
    \begin{align}
      \TnsMrkv_{\thisBin,\thatBin}[\tAbs] &= \int_{\Bot{\SetPartCnts}_{\thisBin}}^{\Top{\SetPartCnts}_{\thisBin}} \Nxt{\PrbBinNxtFmPntNow}[\tAbs](\thatBin|\pnt_{\tAbs}) d\CDF^{\DnsShk}_{\tAbs}.
    \end{align}
  \end{comment}


  \section{Intervals}

  As before, suppose we have a prespecified set of boundaries on the real number line: $\Bot{\SetPartCnts}_{\thisBin},\Top{\SetPartCnts}_{\thisBin}$ for $\thisBin \in \Nteger_{\NumAprxStes+1}$ points that define the boundaries of the intervals we want to use in constructing our Markov chain.  Then the transition probabilities are again
  \begin{align}
    \pnt_{\thisBin} & \equiv \int_{\Bot{\SetPartCnts}_{\thisBin}}^{\Top{\SetPartCnts}_{\thisBin+1}} \pnt d\CDF^{\pnt}
    \\ \Nxt{\PrbBinNxtFmPntNow}[\tAbs](\thatBin|\pnt_{\tAbs},\pShk_{\tAbs+1}) &= 
  \end{align}



  We need to figure out how to divide the continuous state space up into appropriately sized intervals for which each of the


  \section{Anticipation}

  Per the discussion above, our consumers do not believe themselves to be living in a discretization of their economy; they believe they are living in the original continuous economy.

  For any period-$\tAbs$ ending value of $\pnt_{\tAbs}$, expected marginal utility will be:
  \begin{align}
    \vEnd^{\prime}_{\tAbs}(\pnt_{\tAbs}) & \equiv \Ex_{\tAbs}[\uFunc^{\prime}\left(\cFunc(\Rnorm_{\tAbs+1} \pnt_{\tAbs} + \tShk_{\tAbs+1})\right)]
  \end{align}
  which as usual yields consumption and beginning-of-period market resources from
  \begin{align}
    \cRat_{\tAbs} & = (\uFunc^{\prime})^{-1}(\vEnd^{\prime}_{\tAbs})
    \\ \mRat_{\tAbs} & = \pnt_{\tAbs}+\cRat_{\tAbs}
  \end{align}

  \pagebreak

  \onlyinsubfile{\bibliography{\econtexRoot/BufferStockTheory,economics}}

  \appendix

  \section{Numerical Search for $\tShk$}

  But we do have analytical lower and upper bounds for $\cFunc$, which in turn can be used to give us lower and upper bounds for the search region.
  \begin{comment}
    \begin{align}
      \Nxt{\pnt}-\Nxt{\Rnorm} \pnt + \cFunc(\Nxt{\Rnorm}\pnt+\Nxt{\tShk})& = \Nxt{\tShk} 
    \end{align}
  \end{comment}

  Since $\Nxt{\pnt}$ is continuous and strictly increasing in the realization of $\tShk$ and $\SetPartCnts_{\thatBin} \in [\Bot{\SetPartCnts}_{\thatBin},\Top{\SetPartCnts}_{\thatBin}]$, for any given $\Nxt{\Rnorm}$ we can find the lower bound such that ${\Nxt{\pnt}}=\Bot{\SetPartCnts}_{\thatBin}$ and the upper bound such that ${\Nxt{\pnt}}=\Top{\SetPartCnts}_{\thatBin}$
  \begin{align}
    \Bot{\SetPartCnts}_{\thatBin}(\Nxt{\Rnorm}) & =  \Nxt{\Rnorm} \pnt + \Bot{\Nxt{\tShk}} - \cFunc(\Nxt{\Rnorm}\pnt+\Bot{\Nxt{\tShk}})
    \\  \Top{\SetPartCnts}_{\thatBin}(\Nxt{\Rnorm}) & =  \Nxt{\Rnorm} \pnt + \Top{\Nxt{\tShk}} - \cFunc(\Nxt{\Rnorm}\pnt+\Top{\Nxt{\tShk}})
  \end{align}

  \begin{comment}
    For any given current value $\pnt$ (and treating $\Nxt{\DnsShk}$ and $\Nxt{\Rnorm}=\Rfree (\PGro \Nxt{\DnsShk})^{-1}$ as predetermined).
    \begin{align}
      \Target{\pnt}(\tShk) & = 
                               \Nxt{\Rnorm} \pnt + \Nxt{\tShk} - \cFunc(\Nxt{\Rnorm}\pnt+\Nxt{\tShk})
                               \label{eq:implicit}
                               % \\  \Nxt{\pnt} - \tShk & = \left(\Nxt{\Rnorm} \pnt  - \cFunc(\Nxt{\Rnorm}\pnt+\Nxt{\tShk})\right)
    \end{align}
  \end{comment}
  Because $\cFunc$ is not an analytical expression, this is an implicit function, but for `small' $\tShk$ can be approximated by
  a first order Taylor expansion:
  \begin{align}
    \cFunc(\Rnorm \pnt + \tShk) & \approx   \cFunc(\Rnorm \pnt + 1)+ (\tShk-1)\cFunc^{\prime}(\Rnorm \pnt + 1)
  \end{align}
  and shortening $\cFunc^{\prime}(\Rnorm \pnt + 1)$ to $\cFunc^{\prime}$,
  \begin{align}
    \Target{\pnt} & \approx \left(
                      \Nxt{\Rnorm} \pnt  - \cFunc(\Nxt{\Rnorm}\pnt+1)
                      \right)
                      +\Nxt{\tShk}+(\Nxt{\tShk}-1)\cFunc^{\prime}(\Rnorm \pnt + 1)
    \\ \Target{\pnt} -(\cFunc^{\prime}+1)\Nxt{\tShk} & \approx  \left(\Nxt{\Rnorm} \pnt  - (\cFunc(\Nxt{\Rnorm}\pnt+1)\right)-\cFunc^{\prime}
    \\  (\cFunc^{\prime}+1)\Nxt{\tShk} & \approx \Target{\pnt}- \left(\Nxt{\Rnorm} \pnt  - (\cFunc(\Nxt{\Rnorm}\pnt+1))\right)+\cFunc^{\prime}                                             \\  \Nxt{\tShk} & \approx  (1+\cFunc^{\prime})^{-1}\left\{\Target{\pnt}- \left(\Nxt{\Rnorm} \pnt  - (\cFunc(\Nxt{\Rnorm}\pnt+1)\right)+\cFunc^{\prime})\right\}
  \end{align}
  which can serve as the starting point for a numerical search for the `true' value of $\Nxt{\tShk}$ that satisfies \eqref{eq:implicit}.


\end{document}



So for a given $\pDiscBnds_{\thisBin}$ the probability mass for a draw of $\tShk$ that puts you in $\pDiscBnds_{\thatBin}$ is
So for a given $\pDiscBnds_{\thisBin}$ the probability mass for a draw of $\tShk$ that puts you in $\pDiscBnds_{\thatBin}$ is
\begin{align}
  & =    \int_{\underline{\Nxt{\pnt}}_{\thisBin}}^{\bar{\Nxt{\pnt}}_{\thisBin}}\left(\Nxt{\Rnorm} \pnt + \Nxt{\tShk} - \cFunc_{\tAbs+1}(\Nxt{\Rnorm}\pnt+\Nxt{\tShk})\right) d{\CDF(\tShk)}
  % \\ & = \CDF^{\tShk}(\bar{\Nxt{\pnt}}_{\thisBin}-\pDiscBnds_{\thisBin})-\CDF^{\tShk}(\underline{\Nxt{\pnt}}_{\thisBin}-\pDiscBnds_{\thisBin})
  % \\ & = \left(\frac{1}{2}\right)\left(\erf(\bar{\Nxt{\pnt}}_{\thisBin}-\pDiscBnds_{\thisBin})-\erf(\underline{\Nxt{\pnt}}_{\thisBin}-\pDiscBnds_{\thisBin})\right)
         Start with the fact that the CDF of $\aRat[\LoopB]$ is $\aRat_{\LoopA}$ to CDF of point $\aRat_{\tAbs+1}[j]$ is given by

         Suppose we fix the size of the permanent shock at $\pShk[\LoopC]$.  Then the CDF of $\aRat_{\tAbs+1}$ is

         \begin{align}
           \CDF^{\pShk[\LoopC]}(\aRat[\LoopB]|\pShk_{\tAbs+1}=\pShk[\LoopC]) & = \CDF\left(\Rfree (\PGro \pShk[\LoopC])^{-1} \aRat_{\LoopA} + \tShk_{\tAbs+1} - \cFunc_{\tAbs+1}(\Rfree (\PGro \pShk[\LoopC])^{-1}\aRat_{\LoopA}+\tShk_{\tAbs+1})\right)
         \end{align}
                                                                                    which can be calculated easily enough numerically since we know that the RHS is monotonic in $\tShk$.
                                                                                    The CDF across all possible values of $\pShk$ is therefore
                                                                                    \begin{align}
                                                                                      \CDF(\aRat[\LoopB]) & = \sum_{k=1}^{\LoopD}\CDF\left(\Rfree (\PGro \pShk[\LoopC])^{-1} \aRat_{\LoopA} + \tShk_{\tAbs+1} - \cFunc_{\tAbs+1}(\Rfree (\PGro \pShk[\LoopC])^{-1}\aRat_{\LoopA}+\tShk_{\tAbs+1})\right)
                                                                                    \end{align}




                                                                                                               \newcommand{\PMF}{\Pi}


                                                                                                               Now let us define a set of boundaries $\{{\sharp}Bot[\LoopB],{\sharp}Top[\LoopB]\}$


                                                                                                               such that $\underline{\sharp}[0]$ is the minimum possible realization of $\aRat_{\tAbs+1}$ and $\bar{{\sharp}}[-1]$ is the maximum possible realization of $\aRat$.  Furthermore, define the a set of points ${\sharp}[\LoopB]=\int_{\aRat[\LoopB-1]}^{\aRat[\LoopB]}d\CDF(\aRat)\aRat$.  That is, the ${\sharp}[\LoopB]$ constitute the mean value of $\aRat$ conditional on $\aRat$ being in the interval between $\aRat[\LoopB-1]$ and $\aRat[\LoopB]$.  Then we can define the probability mass function as the set of probabilities $\PMF[\LoopB]$ such that, for each point on the interior of ${\sharp}[\LoopB]$, the probability mass is split half and half between the two adjacent points.  For the bottom and top $\PMF$ values, we need to integrate between $\underline{\sharp}[0]$ and $\aRat[1]$ or between $\aRat[-1]$ and $\bar{{\sharp}}$ to obtain the remaining mass associated with the bottommost and topmost points in the $\aRat[\LoopB]$ list.
                                                                                                               \end{document}

                                                                                                               \begin{align}
                                                                                                                 \CDF(\underline{\sharp}[0]) & = 
                                                                                                               \end{align}

                                                                                                             \end{document}
                                                                                                             hithere

                                                                                                             Specifically, ${\pLog}_{\tp\FutPer}$ will be the sum of the $\pLog$ across all cohorts, weighted by their masses (and we can neglect $m=0$ because $\pLog_{\FutPer}[0]=0$):
                                                                                                             \begin{align*}
                                                                                                               {\pLog}_{{\tp}\FutPer} & = \sum_{\LooPer=1}^{\FutPer} \Liv^{\LooPer} {\pLog}_{\FutPer}[\LooPer]
                                                                                                                                        %                                                                                                                                         \sum_{\posn \in \posn_{\FutPer}[\LooPer]}
                                                                                                                                        %       \\ & = \sum_{\LooPer=1}^{\FutPer}  \pLog[\LooPer]
                                                                                                                                        %     \end{align*}
                                                                                                                                        %     where $\pLog[\LooPer] \sim \mathcal{N}(\Liv^{\LooPer} \LooPer \pShkMean,(\Liv^{\LooPer})^{2} \LooPer \sigma^{2}_{\DnsShk})$ which can be rewritten as 
                                                                                                                                        %     \begin{align*}
                                                                                                                                        %       \\  {\pLog}_{{\tp}\FutPer} & = \sum_{\LooPer=1}^{\FutPer} \sum_{\posn \in \posn_{\FutPer}[\LooPer]} \Liv^{\LooPer} {\pLog}_{\FutPer,\posn}[\LooPer]
                                                                                                                                        %       \\ & = \sum_{\LooPer=1}^{\FutPer}  \Liv^{m} \sum_{\NewPer=1}^{\LooPer}\pShk_{\NewPer}
                                                                                                             \end{align*}
                                                                                                             where $\pLog_{\FutPer}[\LooPer] \sim \mathcal{N}(\LooPer \pShkMean,\LooPer \sigma^{2}_{\pShkMean})$. The mean 
                                                                                                             of $\pLog_{\FutPer}$ is therefore:
                                                                                                             \begin{align}
                                                                                                               \bar{\pLog}_{\FutPer} & = \sum_{\LooPer=1}^{\FutPer} \Liv^{\LooPer} \LooPer \pShkMean
                                                                                                               \\  & =\pShkMean \sum_{\LooPer=1}^{\FutPer} \Liv^{\LooPer} \LooPer 
                                                                                                             \end{align}
                                                                                                             and since the variance of a normal variable multiplied by $\Liv^{\LooPer}$ is $(\Liv^{\LooPer})^{2}$,
                                                                                                             \begin{align}
                                                                                                               \var({\pLog}_{\FutPer}) & = \sigma^{2}_{\DnsShk}\sum_{\LooPer=1}^{\FutPer} (\Liv^{\LooPer})^{2} \LooPer
                                                                                                               \\ & = \sigma^{2}_{\DnsShk}\sum_{\LooPer=1}^{\FutPer} (\Liv^{2})^{\LooPer} \LooPer                             
                                                                                                             \end{align}
                                                                                                             but 
                                                                                                             \begin{align}
                                                                                                               \sum_{\LooPer=1}^{\FutPer} \bullet^{\LooPer} \LooPer  & =  \underbrace{\left(\frac{\bullet +((\bullet -1) \FutPer-1) \bullet ^{\FutPer+1}}{(1-\bullet )^2}\right)}  \label{eq:nGeomSum}
                                                                                                             \end{align}
                                                                                                             and note that for $0 < \Liv < 1$ the exponentiated $\Liv$ term approaches zero as $n \uparrow \infty$.  So the limiting value is the remarkably simple formula:
                                                                                                             \begin{align}
                                                                                                               \sum_{\LooPer=1}^{\infty} \bullet^{\LooPer} \LooPer  & = \underbrace{\left(\frac{\bullet}{(1-\bullet)^{2}}\right)}_{\equiv \FutVal(\bullet)} \label{eq:infGeomSum}
                                                                                                             \end{align}
                                                                                                             and we conclude that the steady-state distribution is 
                                                                                                             \begin{align}
                                                                                                               \pLog_{\infty} \sim \mathcal{N}(\FutVal(\Liv)\pShkMean,\FutVal(\Liv^{2})\sigma^{2}_{\DnsShk}).
                                                                                                             \end{align}

                                                                                                             \pagebreak
                                                                                                             \onlyinsubfile{\bibliography{\econtexRoot/BufferStockTheory,economics}}
                                                                                                           \end{document}




                                                                                                           Mean $\pLog$ is the sum of all cohorts' mean $\pLog$'s weighted by the cohort's (relative) population size.  We want to think of the absolute population size as remaining constant at its initial value of $\Pop_{0}$, at which date everyone was a newborn.  Counting upward from that date the absolute size of the initial cohort will shrink geometrically by $\Liv$ per period, so its size relative to the (fixed) population will be $\Liv^{n}$.

                                                                                                           % The population size after $\FutPer$ periods is the initial size each cohort, shrunken geometrically by $\Liv$ for the number of periods it has been alive:
                                                                                                           % \begin{align*}
                                                                                                           %   \Pop_{\FutPer} & =  \overbrace{\Die\Pop_{0}}^{\text{initial}}\sum_{\LooPer=0}^{\FutPer}\Liv^{\LooPer}
                                                                                                           %   \\ & =  (1-\Liv) \Pop_{0}\left(\frac{1-\Liv^{\FutPer+1}}{1-\Liv}\right).
                                                                                                           %   \\ & =  \Pop_{0}\left(1-\Liv^{\FutPer+1}\right).
                                                                                                           % \end{align*}

                                                                                                           \begin{comment} % The version below was for the case where the initial size of the newborn population is constant from the beginning
                                                                                                             \together{
                                                                                                               Using an overbar to denote expected per-capita values, (e.g., $\bar{\pLog}_{\FutPer}[\LooPer]=\Ex_{\posn_{\FutPer}[\LooPer]}[\pLog_{\FutPer}][\LooPer]] = \LooPer \pShkMean$), $\bar{\pLog}_{\tp\FutPer}$ will be the sum of the expected $\pLog$ across all cohorts, weighted by their masses and divided by the total population size:\footnote{See below for a \texttt{Mathematica} command that verifies this derivation.}
                                                                                                               % : $\pShk \sim \mathcal{N}(\pShkMean,\sigma_{\DnsShk})$ (where $\pShkMean=-\sigma^{2}_{\DnsShk}/2$ guarantees $\Ex[\Psi]=1$). By period $n$, $\pLog$ has drifted from $\pLog_{0}=0$ to
                                                                                                               \begin{align*}
                                                                                                                 \bar{\pLog}_{{\tp}\FutPer} & = \overbrace{\Die\Pop^{-1}_{\FutPer}}^{\text{Popn size}}\sum_{\LooPer=0}^{\FutPer}\Liv^{\LooPer} \bar{\pLog}_{\FutPer}[\LooPer]
                                                                                                                 \\ & =  \Die\Pop^{-1}_{\FutPer}\pShkMean\sum_{\LooPer=0}^{\FutPer}\Liv^{\LooPer} \LooPer
                                                                                                                 \\ & =   \Die \pShkMean \Pop^{-1}_{\FutPer} \left(\frac{\Liv-n \Liv^{\FutPer}+(n-1)\Liv^{\FutPer+1})}{(1-\Liv)^{2}}\right)
                                                                                                                 \\ & =  \Die \pShkMean \left(\frac{1-\Liv^{\FutPer+1}}{1-\Liv}\right)\left(\frac{\Liv-n \Liv^{\FutPer}+(n-1)\Liv^{\FutPer+1})}{(1-\Liv)^{2}}\right)
                                                                                                                 \\ & = \Die \pShkMean 
                                                                                                                 % \left(\frac{\left(\Liv^n-1\right)\left(\Liv+(n-1) \Liv^{\FutPer+1}-n \Liv^n\right)}{(\Liv-1)^3}\right)
                                                                                                                 % \left(\frac{\Liv  \left(\Liv^{\FutPer+1}-1\right) \left(n \Liv^{\FutPer+1}-(n+1) \Liv^n+1\right)}{(\Liv -1)^3}\right)
                                                                                                                 % \\ & =             \left(\frac{\Liv  \left(\Liv^{\FutPer+1}-1\right) \left(n \Liv^{\FutPer+1}-(n+1) \Liv^n+1\right)}{(\Liv -1)^3}\right)
                                                                                                                 % \\ & =             \left(\frac{\Liv  \left(1-\Liv^{\FutPer+1}\right) \left(n \Liv^{\FutPer+1}-(n+1) \Liv^n+1\right)}{(1-\Liv)^3}\right)
                                                                                                                 % \\ & =             \left(\frac{\Liv  \left(1-\Liv^{\FutPer+1}\right) \left(n (\Liv^{\FutPer+1}- \Liv^n)+\Liv^{\FutPer}+1\right)}{(1-\Liv)^3}\right)
                                                                                                                 % \\ & =
                                                                                                                        \left(\frac{\left(1-\Liv ^{\FutPer+1}\right)\left(\Liv -n(1-\Liv ) \Liv ^{\FutPer+1}-\Liv ^{\FutPer+1}\right)}{(1-\Liv )^3}       \right) \label{eq:FutVal}
                                                                                                               \end{align*}
                                                                                                               or, recalling that $\Die = 1-\Liv$, it will be convenient to define:
                                                                                                               \begin{align}
                                                                                                                 \FutVal_{n}(\Liv) & = \left(\frac{\left(1-\Liv ^{\FutPer+1}\right)\left(\Liv -n(1-\Liv ) \Liv ^{\FutPer+1}-\Liv ^{\FutPer+1}\right)}{(1-\Liv )^2}       \right)
                                                                                                               \end{align}
                                                                                                               so that the expression in \eqref{eq:FutVal} can be compactly written as $\pShkMean \FutVal_{n}(\Liv)$.
                                                                                                             }
                                                                                                           \end{comment}
                                                                                                           \indent Using an overbar to denote expected per-capita values, (e.g., $\bar{\pLog}_{\FutPer}[\LooPer]=\Ex_{\posn_{\FutPer}[\LooPer]}[\pLog_{\FutPer}][\LooPer]] = \LooPer \pShkMean$), $\bar{\pLog}_{\tp\FutPer}$ will be the sum of the expected $\pLog$ across all cohorts, weighted by their masses (and we can neglect $m=0$ because $\pLog_{\FutPer}[0]=0$):
                                                                                                           \begin{align*}
                                                                                                             \bar{\pLog}_{{\tp}\FutPer} & = \sum_{\LooPer=1}^{\FutPer}\Liv^{\LooPer} \bar{\pLog}_{\FutPer}[\LooPer]
                                                                                                             \\  & = \sum_{\LooPer=1}^{\FutPer}\Liv^{\LooPer} \LooPer \pShkMean 
                                                                                                             \\  & = \pShkMean \sum_{\LooPer=1}^{\FutPer}\Liv^{\LooPer} \LooPer 
                                                                                                           \end{align*}
                                                                                                           but
                                                                                                           \begin{align}
                                                                                                             \sum_{\LooPer=0}^{\FutPer}\Liv^{\LooPer} \LooPer & = \frac{\Liv +((\Liv -1) \FutPer-1) \Liv ^{\FutPer+1}}{(1-\Liv )^2} \label{eq:nGeomSum}
                                                                                                           \end{align}
                                                                                                           so
                                                                                                           \begin{align}
                                                                                                             \bar{\pLog}_{\FutPer}[\LooPer] & =  \left(\frac{\Liv +((\Liv -1) \FutPer-1) \Liv ^{\FutPer+1}}{(1-\Liv )^2}\right)\pShkMean.
                                                                                                           \end{align}
                                                                                                           Now note that for $0 < \Liv < 1$ the exponentiated $\Liv$ term approaches zero as $n \uparrow \infty$.  So the limiting value is the remarkably simple formula:
                                                                                                           \begin{align}
                                                                                                             \bar{\pLog}_{\infty} & = \left(\frac{\Liv}{(1-\Liv)^{2}}\right).
                                                                                                           \end{align}

                                                                                                           % \begin{align}
                                                                                                           %   \Ex[\{\pLog_{n}\}] & = \Ex[(\sum_{m=0}^{n} \Liv^{\LooPer} (\pLog_{\FutPer,\posn}[\LooPer]))^{2}]
                                                                                                           %   \\ & = \Ex[(\sum_{m=0}^{n} (\Liv^{\LooPer})^{2} (\var(\pLog_{n}[m])+\Ex[\pLog_{n}[m]^{2}])]                       
                                                                                                           % \end{align}

                                                                                                           Because $\{\pLog_{{\tp}\FutPer}\}$ is a set of sets of independent normal variables and death is IID, we can also derive the cross-sectional variance as the weighted sum of a set of normal distributions:
                                                                                                           \begin{align}
                                                                                                             \var(\pLog_{n}) & = \var(\sum_{\LooPer=1}^{\FutPer}\{\pLog_{\FutPer}[\LooPer]\})
                                                                                                             \\ & = \var(\sum_{\LooPer=1}^{\FutPer}\{\pLog_{\FutPer}[\LooPer]\})                    
                                                                                                             \\ & = \var(\sum_{\LooPer=1}^{\FutPer})                    
                                                                                                           \end{align}


                                                                                                           Across $\posn$, $\pLog_{\FutPer,\posn}[\LooPer]$ is a sum of normally distributed $\pShk$'s:
                                                                                                           \begin{align}
                                                                                                             \var(\{\pLog_{\FutPer}\}) & = \sum_{m=0}^{n} \Liv^{\LooPer} \Ex[\{\pLog_{\FutPer}[\LooPer]\}^{2}] -\left(\sum_{m=0}^{n} \Liv^{\LooPer}(\pShkMean \LooPer)\right)^{2}
                                                                                                             \\  & =  \sum_{m=0}^{n} \Liv^{\LooPer} (\LooPer^{2} \sigma^{2} + \LooPer^{2} \pShkMean^{2})  -\left(\sum_{m=0}^{n} \Liv^{\LooPer}(\pShkMean \LooPer)\right)^{2}
                                                                                                             \\  & =  \sum_{m=0}^{n} \Liv^{\LooPer} \LooPer \sigma^{2}_{\DnsShk} -\left(\sum_{m=0}^{n} \Liv^{\LooPer}(\pShkMean \LooPer)\right)^{2}
                                                                                                             \\  & =  \sum_{m=0}^{n} \Liv^{\LooPer}\left( \LooPer \sigma^{2}_{\DnsShk} + (\LooPer \pShkMean)^{2}\right) -\left(\sum_{m=0}^{n} \Liv^{\LooPer}(\pShkMean \LooPer)\right)^{2}
                                                                                                           \end{align}


                                                                                                           \begin{align}
                                                                                                             \var(\{\pLog_{\FutPer}\}) & = \var(\sum_{m=0}^{n} \Liv^{\LooPer} (\pLog_{\FutPer,\posn}[\LooPer]))
                                                                                                             \\ & = \sum_{\LooPer=0}^{\FutPer}(\Liv^{\LooPer})^{2} \LooPer \sigma^{2}_{\DnsShk}                              
                                                                                                             \\ & = \sum_{\LooPer=0}^{\FutPer}(\Liv^{2})^{\LooPer} \LooPer \sigma^{2}_{\DnsShk}
                                                                                                             \\ & =  \sigma^{2}_{\DnsShk}\left(\frac{\Liv^{2}(1-(\Liv^{2})^{\FutPer}-\FutPer (\Liv^{2})^{\FutPer}+\FutPer (\Liv^{2})^{1+\FutPer})}{(-1+\Liv^{2})^{2}}\right)
                                                                                                             \\ & =  \sigma^{2}_{\DnsShk}\left(\frac{\Liv^{2}(1-(\Liv^{2})^{\FutPer}+\FutPer (\Liv^{2})^{\FutPer}(\Liv^{2}-1))}{(\Liv^{2}-1)^{2}}\right)       
                                                                                                             % \\  & = \var(\sum_{m=0}^{n} \Liv^{\FutPer} (\sum_{i=0}^{\LooPer}\pShk_{\LooPer,\posn}))
                                                                                                           \end{align}

                                                                                                           \begin{align}
                                                                                                             \var(\{\pLog_{\FutPer}\}) & = \var(\sum_{m=0}^{n} \Liv^{\LooPer} (\pLog_{\FutPer,\posn}[\LooPer]))
                                                                                                             \\ & = \sum_{\LooPer=0}^{\FutPer}(\Liv^{\LooPer})^{2} \LooPer \sigma^{2}_{\DnsShk}                              
                                                                                                             \\ & = \sum_{\LooPer=0}^{\FutPer}(\Liv^{2})^{\LooPer} \LooPer \sigma^{2}_{\DnsShk}
                                                                                                             \\ & =  \sigma^{2}_{\DnsShk}\left(\frac{\Liv^{2}(1-(\Liv^{2})^{\FutPer}-\FutPer (\Liv^{2})^{\FutPer}+\FutPer (\Liv^{2})^{1+\FutPer})}{(-1+\Liv^{2})^{2}}\right)
                                                                                                             \\ & =  \sigma^{2}_{\DnsShk}\left(\frac{\Liv^{2}(1-(\Liv^{2})^{\FutPer}+\FutPer (\Liv^{2})^{\FutPer}(\Liv^{2}-1))}{(\Liv^{2}-1)^{2}}\right)       
                                                                                                             % \\  & = \var(\sum_{m=0}^{n} \Liv^{\FutPer} (\sum_{i=0}^{\LooPer}\pShk_{\LooPer,\posn}))
                                                                                                           \end{align}
                                                                                                           and since the weighted sum of independent random variables is 
                                                                                                           \begin{align}
                                                                                                             \var(\{\pLog_{0}\}) & = 0
                                                                                                             \\ \var(\{\pLog_{1}\}) & = \var(\Die \pLog_{0} + \Liv \pLog_{1})
                                                                                                             \\ \var(\{\pLog_{1}\}) & = \Liv \Ex[(\pLog_{1}-\pShkMean)^{2}]
                                                                                                             \\ \var(\{\pLog_{2}\}) & = \Liv^{2} \Ex[(\pLog_{2}-2 \pShkMean)^{2}]
                                                                                                           \end{align}

                                                                                                           Because the variance of the sum of independent variables is the sum of the variances, for each location $\posn$ in the set $\{\posn_{{\tp}\FutPer}[\LooPer]\}$,
                                                                                                           \begin{align}
                                                                                                             \var\left(\pLog_{{\tp}\FutPer,\posn}\right) &= \var\left[\sum_{\LooPer=0}^{\FutPer}\pShk_{{\tp}\FutPer,\posn}\right] = \FutPer \sigma^{2}_{\DnsShk}.
                                                                                                           \end{align}

                                                                                                           \begin{comment}


                                                                                                             the expectation of the variance of their contribution to
                                                                                                             the distribution of $\pLog$ in period ${\tp}\FutPer$ is the weighted average of the variances of those who live and those who die.
                                                                                                             If \newcommand{\LivThru}{\mathbbm{1}}$\LivThru_{\tAbs,\posn}^{\FutPer}$ is an indicator variable in each period ${\tp}\FutPer$ for whether the person at position $\posn$ at date $\tAbs$ will survive through period ${\tp}\FutPer$, then from the perspective of period $\tAbs$ the expectation of the variance of $\pLog$ among currently-alive persons who survive to ${\tp}n$ is 
                                                                                                             \begin{eqnarray}
                                                                                                               \Ex_{\tAbs}[\var(\{\pLog_{{\tp}\FutPer,\posn}\})] & = & \Ex_{\tAbs}[\LivThru^{\FutPer}_{\tAbs,\posn}(\pLog_{{\tp}\FutPer,\posn}-\FutPer\pShkMean)^{2}+(1-\LivThru^{\FutPer}_{\tAbs,\posn})\times 0]
                                                                                                             \end{eqnarray}
                                                                                                             but $\LivThru^{\FutPer}_{\tAbs,\posn}$ and $\pLog_{{\tp}\FutPer,\posn}$ are independent random variables and $\Ex_{\tAbs} \LivThru^{\FutPer}_{\FutPer,\posn}=\Liv^{\FutPer}$, so this reduces to 
                                                                                                             \begin{align}
                                                                                                               \Ex_{\tAbs}[\var(\{\pLog_{{\tp}\FutPer,\posn}\})] & =  \Ex_{\tAbs}[(\Liv^{\FutPer}(\pLog_{{\tp}\FutPer,\posn}-\pShkMean)^{2}]
                                                                                                               \\ & =  \Liv^{\FutPer} \FutPer \sigma^{2}_{\DnsShk}.
                                                                                                             \end{align}

                                                                                                           \end{comment}

                                                                                                           The variance across the entire population will be the sum of the variances of each subpopulation divided by the size of the population:
                                                                                                           \begin{eqnarray}
                                                                                                             \var(\{\pLog_{{\tp}\FutPer}\}) & = & \Pop_{\FutPer}^{-1}\sigma^{2}_{\DnsShk} \sum_{\LooPer=0}^{\FutPer} \Liv^{\LooPer} n
                                                                                                           \end{eqnarray}
                                                                                                           which is exactly the same formula as for the mean, but substituting $\sigma^{2}_{\DnsShk}$ for $\pShkMean$.

                                                                                                           The upshot is that 
                                                                                                           \begin{align}
                                                                                                             \lim_{\FutPer \rightarrow \infty} \pLog_{{\tp}\FutPer} &  \sim \mathcal{N}(\pShkMean \FutVal_{\infty}(\Liv), \sigma^{2}_{\DnsShk} \FutVal_{\infty}(\Liv))
                                                                                                           \end{align}

                                                                                                           \pagebreak
                                                                                                           \subsubsection{Mathematica Verification of Derivations}
\begin{verbatim}
FullSimplify[
Sum[p^m,{m,0,n}] Sum[m p^m,{m,0,n}]-((1-p^(1+\FutPer))
(p-p^(1+n)n(1-p)-p^(1+n)))/(1-p)^3==0
,Assumptions->{0<p<1,n>0}] 
\end{verbatim}

                                                                                                           \section{Simulation Algorithm}

                                                                                                         \end{document}


                                                                                                         Start by recalling that 
                                                                                                         \begin{eqnarray}
                                                                                                           \{\pLog_{{\tp}\FutPer}\} & = & \bigcup_{\LooPer=0}^{\FutPer}\{\pLog_{{\tp}\FutPer}[n]\}
                                                                                                         \end{eqnarray}



                                                                                                         Calling the cohort of persons who in period $\tAbs$ have been alive $n$ periods $\{\Liv_{\tAbs,n}\}$, for each such person
                                                                                                         \begin{eqnarray*}
                                                                                                           \pLog_{\tAbs,0}   & =  & \Liv^{0}  \times 0 
                                                                                                           \\ \pLog_{\tAbs,1}& =  & \Liv^{1}(\phantom{2}\pShk_{\tAbs-1,1})
                                                                                                           \\ \pLog_{\tAbs,2}& = & \Liv^{2}(2\pShk_{\tAbs-1,2}+\pShk_{\tAbs-2,2})
                                                                                                           \\  & \vdots
                                                                                                           \\ \pLog_{\tAbs,n}& =&  \Liv^{\LooPer}\left(n \sum_{\FutPer=1}^{\LooPer}\pShk_{\tAbs-\FutPer,\FutPer}\right)
                                                                                                         \end{eqnarray*}
                                                                                                         so aggregate income of the cohorts born $k$ periods ago and later is given by the double sum
                                                                                                         \begin{align}
                                                                                                           \PLev_{\tAbs}^{k} & = \sum_{\LooPer=0}^{k} \Liv^{\LooPer}\left(n \pShkMean \sum_{\FutPer=1}^{\LooPer}\pShk_{\tAbs-\FutPer,\FutPer}\right)
                                                                                                         \end{align}
                                                                                                         but since the permanent shocks are all iid ($\Ex[\pShk_{\tAbs,\FutPer}]=-\sigma^{2}/2 ~~ \forall ~t,\FutPer$),
                                                                                                         the ergodic expected level of permanent income is
                                                                                                         \begin{align}
                                                                                                           \Ex[\PLev_{\tAbs}] & =  \sum_{\LooPer=0}^{\infty} \Liv^{\LooPer}n\left( \pGro - \sigma^{2}_{\DnsShk}/2\right)
                                                                                                           \\ = & \left(\frac{\Liv}{(1-\Liv)^{2}}\right)(\pGro-\sigma^{2}_{\DnsShk}/2)
                                                                                                         \end{align}

                                                                                                         \newpage
                                                                                                         It is often more useful, in these kinds of problems, to express everything in `per capita' terms.  In the limit, the population size will be
                                                                                                         \begin{align*}
                                                                                                           \LLev & = 1 + \Liv + \Liv^{2} + ...
                                                                                                           \\  & =  \left(\frac{1}{1-\Liv}\right)            
                                                                                                         \end{align*}
                                                                                                         so per capita log income $\bar{\pLog}$ will be
                                                                                                         \begin{align*}
                                                                                                           \bar{\pLog} & = \PLev \times (1-\Liv)
                                                                                                           \\ & =  \left(\frac{\Liv}{(1-\Liv)}\right)(\pGro-\sigma^{2}_{\DnsShk}/2)
                                                                                                         \end{align*}
                                                                                                         Since the variance of the sum of iid normals equals the sum of the variances, we can also calculate:
                                                                                                         \begin{align*}
                                                                                                           \var(P_{\tAbs}) & = \var\left(\sum_{\LooPer=0}^{\infty} \left( \sum_{\FutPer=1}^{\LooPer}\Liv^{\LooPer}\pShk_{\tAbs-\FutPer,\FutPer}\right)\right)
                                                                                                           \\                  & = \sum_{\LooPer=0}^{\infty} \left( \sum_{\FutPer=1}^{\LooPer}\var(\Liv^{\LooPer}\pShk_{\tAbs-\FutPer,\FutPer})\right)
                                                                                                           \\               &   = \var\left(\sum_{\LooPer=0}^{\infty}n(\Liv^{2})^{\LooPer}\sigma^{2}_{\DnsShk}\right)
                                                                                                           \\ & = \left(\frac{\Liv^{2}}{(\Liv^{2}-1)^{2}}\right)\sigma^{2}_{\DnsShk}         
                                                                                                         \end{align*}

                                                                                                         Thus, there is an ergodic distribution of permanent income:
                                                                                                         \begin{eqnarray}
                                                                                                           \PLev \sim \mathcal{\LooPer}\left(\left(\frac{\Liv}{(1-\Liv)^{2}}\right)(\pGro-\sigma^{2}_{\DnsShk}/2),\left(\frac{\Liv^{2}}{(\Liv^{2}-1)^{2}}\right)\sigma^{2}_{\DnsShk}\right)
                                                                                                         \end{eqnarray}
                                                                                                         which makes a convenient starting point for simulations.

                                                                                                         \begin{eqnarray}
                                                                                                           Mean & Variance & Pop
                                                                                                           \\  0    & 0        & 1
                                                                                                           \\ \mu \Liv & \Liv^{2} \sigma^{2} & 1+\Liv
                                                                                                         \end{eqnarray}
                                                                                                         \begin{tabular}{llll}
                                                                                                                                               %                                                                                                                                                \text{Cohort 0} & & \text{Cohort 1} & & 
                                                                                                                                                                                                                                                                                                                                        $     & \Liv^{0}\psi_{0,0} &
                                                                                                           \\   & \Liv^{1}\psi_{0,0} &+ & \Liv^{0}\psi_{1,1}(1-\Liv)
                                                                                                           \\   & \Liv^{2}\psi_{0,0} &+ & \Liv^{1}\psi_{1,1}(1-\Liv)+\Liv^{0}\psi_{2,2}(1-\Liv)   
                                                                                                                                          %       \\   & (1-\Liv)^{2}0 + &\Liv^{2}\psi_{0,0} + & \Liv^{1}\psi_{1,1}(1-\Liv)+\Liv^{0}\psi_{2,2}(1-\Liv)
                                                                                                                                                                                                 %       \\ (1-\Liv)^{2}0 + &\Liv^{2}\psi_{0,0} + & \Liv^{1}\psi_{1,1}(1-\Liv)+\Liv^{0}\psi_{2,2}(1-\Liv)                                                         
                                                                                                                                                                                                                                                    $  \end{tabular}

                                                                                                                                                                                                                                                  Ordering the cohorts in the population at date 0 from youngest to oldest, and writing $\psi_{c,-t}$ as the shock received by cohort $c$ periods $\tAbs$ before the present,
                                                                                                                                                                                                                                                  the status of each cohort in period 0 is:

                                                                                                                                                                                                                                                  \begin{tabular}{llll}$
                                                                                                                                                                                                                                                    % t &  
                                                                                                                                                                                                                                                          0   & \Liv^{0}\psi_{0,0} &
                                                                                                                                                                                                                                                    \\ 1   & \Liv^{1}\psi_{1,1} &+ & \Liv^{1}\psi_{1,0}
                                                                                                                                                                                                                                                    \\ 2  & \Liv^{2}\psi_{2,2} &+ & \Liv^{2}\psi_{2,1}+\Liv^{2}\psi_{3,0}
                                                                                                                                                                                                                                                                                    $

                                                                                                                                                                                                                                                  \end{tabular}
                                                                                                                                                                                                                                                  and this sequence can be captured by
                                                                                                                                                                                                                                                  \begin{align}
                                                                                                                                                                                                                                                    \text{cohort n in period 0} & = \Liv^{\LooPer} \sum_{i=0}^{\LooPer} \pShk_{\LooPer,\posn-n}
                                                                                                                                                                                                                                                  \end{align}
                                                                                                                                                                                                                                                  so the total is given by
                                                                                                                                                                                                                                                  \begin{align}
                                                                                                                                                                                                                                                    \sum_{i=0}^{\infty} \Liv^{i} \sum_{j=0}^{i} \pShk_{i,j}
                                                                                                                                                                                                                                                  \end{align}
                                                                                                                                                                                                                                                  and since the $\pShk$ are iid with mean $\mu$, the expectation of this is
                                                                                                                                                                                                                                                  \begin{align}
                                                                                                                                                                                                                                                    \Ex_{0}[\sum_{i=0}^{\infty} \Liv^{i} i \mu] & = \left(\frac{1}{1-\Liv}\right)
                                                                                                                                                                                                                                                  \end{align}
                                                                                                                                                                                                                                                  \begin{align}
                                                                                                                                                                                                                                                    \text{var} & =\Ex_{0}[\sum_{i=0}^{\infty} \Liv^{2 i} \sigma^{2}_{\DnsShk}]
                                                                                                                                                                                                                                                  \end{align}
                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                  \begin{align}
                                                                                                                                                                                                                                                    1    & \mu
                                                                                                                                                                                                                                                    \\2 & \mu + \aleph (2 \mu)
                                                                                                                                                                                                                                                          3  \\ & \mu + \aleph (2 \mu) + \aleph^{2}(3 \mu) +
                                                                                                                                                                                                                                                  \end{align}
                                                                                                                                                                                                                                                  This would be easy to add up for, say, 10000 periods
                                                                                                                                                                                                                                                  \begin{align}
                                                                                                                                                                                                                                                    \var_{0}  & = 0
                                                                                                                                                                                                                                                    \\ \var_{1} & = \aleph(\sigma^{2})
                                                                                                                                                                                                                                                    \\ \var_{2} & = \aleph (\var_{1}+\sigma^{2})
                                                                                                                                                                                                                                                    \\ \var_{2} & = \aleph (\aleph\sigma^{2}+\sigma^{2})
                                                                                                                                                                                                                                                    \\ \var_{2} & = (\aleph^{2} + \aleph) \sigma^{2}
                                                                                                                                                                                                                                                    % \\ & = \aleph(\aleph \sigma^{2}) + \aleph \sigma^{2}
                                                                                                                                                                                                                                                    \\ \var_{3} & = \aleph (\var_{2}+\aleph)\sigma^{2}
                                                                                                                                                                                                                                                    \\ \var_{3} & = \aleph ( (\aleph^{2} + \aleph) \sigma^{2}+\aleph)\sigma^{2}
                                                                                                                                                                                                                                                    \\ \var_{3} & = \aleph \var_{2}+\aleph^{\LooPer}\sigma^{2}
                                                                                                                                                                                                                                                    \\ \var_{3} & = \aleph (\aleph\aleph\sigma^{2}+\aleph\sigma^{2}+\aleph\sigma^{2})
                                                                                                                                                                                                                                                    \\ \var_{3} & = \aleph^{3}\sigma^{2}+\aleph^{2}\sigma^{2}+\aleph\sigma^{2}
                                                                                                                                                                                                                                                    \\ \var_{3} & = (\aleph^{3}+\aleph^{2}+\aleph)\sigma^{2}
                                                                                                                                                                                                                                                    \\  & = \aleph^{3}3\sigma^{2}+\aleph^{2}2\sigma^{2}+\aleph\sigma^{2}
                                                                                                                                                                                                                                                    \\          & = \sigma^{2}\sum_{\LooPer=1}^{t} \aleph^{2 n}n
                                                                                                                                                                                                                                                  \end{align}
                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                  \begin{align}
                                                                                                                                                                                                                                                    \var_{1} & = \var(\aleph x_{1,0})
                                                                                                                                                                                                                                                    \\ \var_{2} &= \var(\aleph x_{2,1}) + \var (\aleph^{2}(x_{1,0}+x_{2,0})))
                                                                                                                                                                                                                                                    \\ \var_{3} &= \var(\aleph x_{3,2}) + \var (\aleph^{2}(x_{2,1}+x_{3,1}))) + \var (\aleph^{3}(x_{1,0}+x_{2,0}+x_{3,0})))
                                                                                                                                                                                                                                                                  c/    \\ & = \aleph^{2} \sigma^{2} + \aleph^{4}(2 \sigma^{2}) + \aleph^{6} (3 \sigma^{2})
                                                                                                                                                                                                                                                    \\ & = \sigma^{2} \sum_{\LooPer=1}^{t} \aleph^{2 n} n         
                                                                                                                                                                                                                                                  \end{align}
                                                                                                                                                                                                                                                  \providecommand{\pLog}{\ensuremath{p}}


                                                                                                                                                                                                                                                \end{document}


                                                                                                                                                                                                                                                Per-capita income will be the total amount of income divided by the size of the population:  
                                                                                                                                                                                                                                                \begin{align}
                                                                                                                                                                                                                                                  \pSim_{0} & = \Pop^{-1}_{0}\left(\Liv^{0}\pLog_{0}\right)
                                                                                                                                                                                                                                                  \\ \pSim_{1} & = \Pop^{-1}_{1}\left(\Liv^{0}\pLog_{0}+\Liv^{1}\pLog_{1}\right)
                                                                                                                                                                                                                                                  \\ \pSim_{2} & = \Pop^{-1}_{2}\left(\Liv^{0}\pLog_{0}+\Liv^{1}\pLog_{1}+\Liv^{2}\pLog_{2}\right)
                                                                                                                                                                                                                                                  \\ \vdots & = \vdots
                                                                                                                                                                                                                                                  \\ \pSim_{\FutPer} & = \Pop^{-1}_{\FutPer}\left(\sum_{i=0}^{\FutPer}\Liv^{i}\pLog_{i}\right)
                                                                                                                                                                                                                                                \end{align}

                                                                                                                                                                                                                                                And the cross-sectional mean and variance will be:
                                                                                                                                                                                                                                                \begin{align}
                                                                                                                                                                                                                                                  \Ex[\pSim_{\FutPer}] & = 
                                                                                                                                                                                                                                                \end{align}
                                                                                                                                                                                                                                                


\newpage  We can similarly compute that for the limiting distribution, the proportion of the mass accounted for by persons older than $\FutPer$ is obtainable as follows:
  \begin{align*}
\PDF(\pLog_{\infty})   = &   \frac{\sum _{\LooPer=1}^{\infty} 
                            \Liv^{\LooPer-1}
                            \exp({-\frac{(\pLog_{\LooPer}-\LooPer \pShkMean )^2}{2
                            \LooPer \sigma_{\DnsShk} ^2}})}{
                            \sigma_{\DnsShk} \sqrt{2 \pi }
                            \sum_{\LooPer=1}^{\infty}\Liv^{\LooPer}
                            }
\\ \PDF(\pLog_{\infty}) =  &  \lefteqn{\frac{\sum _{\LooPer=1}^{\FutPer} 
                            \Liv^{\LooPer-1}
                            \exp({-\frac{(\pLog_{\LooPer}-\LooPer \pShkMean )^2}{2
                            \LooPer \sigma_{\DnsShk} ^2}})}{
                            \sigma_{\DnsShk} \sqrt{2 \pi }
                            \sum_{\LooPer=1}^{\FutPer}\Liv^{\LooPer}
                              }}
\\ & + \frac{\sum _{\LooPer=\FutPer+1}^{\infty} 
                            \Liv^{\LooPer-1}
                            \exp({-\frac{(\pLog_{\LooPer}-\LooPer \pShkMean )^2}{2
                            \LooPer \sigma_{\DnsShk} ^2}})}{
                            \sigma_{\DnsShk} \sqrt{2 \pi }
                            \sum_{\LooPer=\FutPer+1}^{\infty}\Liv^{\LooPer}
                            }                              
  \end{align*}
  and the ratio of the second term to the total is 
  \begin{align*}
\\ &  \frac{\frac{\sum _{\LooPer=\FutPer+1}^{\infty} 
                            \Liv^{\LooPer-1}
                            \exp({-\frac{(\pLog_{\LooPer}-\LooPer \pShkMean )^2}{2
                            \LooPer \sigma_{\DnsShk} ^2}})}{
                            \sum_{\LooPer=\FutPer+1}^{\infty}\Liv^{\LooPer}
     }}{     {\frac{\sum _{\LooPer=1}^{\infty} 
                            \Liv^{\LooPer-1}
                            \exp({-\frac{(\pLog_{\LooPer}-\LooPer \pShkMean )^2}{2
                            \LooPer \sigma_{\DnsShk} ^2}})}{
                            \sum_{\LooPer=1}^{\infty}\Liv^{\LooPer}
                            }}}
\\ &  \frac{(\sum_{\LooPer=1}^{\infty}\Liv^{\LooPer})\sum _{\LooPer=\FutPer+1}^{\infty} 
                            \Liv^{\LooPer-1}
                            \exp({-\frac{(\pLog_{\LooPer}-\LooPer \pShkMean )^2}{2
                            \LooPer \sigma_{\DnsShk} ^2}})}{(\sum _{\LooPer=1}^{\infty} 
                            \Liv^{\LooPer-1}
                            \exp({-\frac{(\pLog_{\LooPer}-\LooPer \pShkMean )^2}{2
                            \LooPer \sigma_{\DnsShk} ^2}}))
                            \sum_{\LooPer=\FutPer+1}^{\infty}\Liv^{\LooPer}}
\\ &  \frac{(\sum_{\LooPer=\phantom{\FutPer+}1}^{\infty}\Liv^{\LooPer})(\sum _{\LooPer=\FutPer+1}^{\infty} 
                            \Liv^{\LooPer-1}
                            \exp({-\frac{(\pLog_{\LooPer}-\LooPer \pShkMean )^2}{2
                            \LooPer \sigma_{\DnsShk} ^2}}))}{(                            \sum_{\LooPer=\FutPer+1}^{\infty}\Liv^{\LooPer})(\sum _{\LooPer=\phantom{\FutPer+}1}^{\infty} 
                            \Liv^{\LooPer-1}
                            \exp({-\frac{(\pLog_{\LooPer}-\LooPer \pShkMean )^2}{2
     \LooPer \sigma_{\DnsShk} ^2}}))}
  \end{align*}
  or the ratio fo the first $\FutPer$ terms to the total is 
  \begin{align*}
 &  \frac{(\sum_{\LooPer=1}^{\infty}\Liv^{\LooPer})(\sum _{\LooPer=1}^{\FutPer} 
                            \Liv^{\LooPer-1}
                            \exp({-\frac{(\pLog_{\LooPer}-\LooPer \pShkMean )^2}{2
                            \LooPer \sigma_{\DnsShk} ^2}}))}{(                            \sum_{\LooPer=1}^{\FutPer}\Liv^{\LooPer})(\sum _{\LooPer=1}^{\infty} 
                            \Liv^{\LooPer-1}
                            \exp({-\frac{(\pLog_{\LooPer}-\LooPer \pShkMean )^2}{2
   \LooPer \sigma_{\DnsShk} ^2}}))}
   & = 
  \end{align*}

